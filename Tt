[
  {
    "type": "xhr",
    "startTime": 64469.10000000894,
    "method": "GET",
    "url": "/api/v1/chats?page_num=999",
    "status": 200,
    "endTime": 64978.60000000894,
    "duration": 509.5
  },
  {
    "type": "fetch",
    "url": "https://public-frontend-cos.metadl.com/nuxt-mgx/prod/assets/Please%20select%20a%20specific%20file%20in%20File%20first.BIhvOukj.svg",
    "method": "GET",
    "startTime": 64818.20000000298,
    "status": 200,
    "endTime": 64980.5,
    "duration": 162.29999999701977
  },
  {
    "type": "xhr",
    "startTime": 64817.80000001192,
    "method": "GET",
    "url": "/api/v1/files?path=%2Fchats%2Fb42fab31a6264b18b0390a285edfed19%2Fworkspace%2F",
    "status": 200,
    "endTime": 65361.10000000894,
    "duration": 543.2999999970198
  },
  {
    "type": "xhr",
    "startTime": 64900.90000000596,
    "method": "GET",
    "url": "/api/v1/files/download?path=%2Fchats%2Fb42fab31a6264b18b0390a285edfed19%2Fworkspace%2FPSLV.py",
    "status": 200,
    "endTime": 65459.80000001192,
    "duration": 558.9000000059605,
    "responseText": "# PSLV SplashScreen launch node - Updated with Light Theme\n# =============================================================================\n# This module contains the updated starting code for PSLV Launcher with light theme\n# Single window that transitions from loading screen to main application\n# ***\n\nimport os\nimport sys\nfrom time import sleep\n\nimport pandas as pd\nimport urllib3\nfrom PyQt6.QtCore import Qt, QThread, pyqtSignal, QTimer\nfrom PyQt6.QtGui import QIcon\nfrom PyQt6.QtWidgets import QApplication, QMainWindow, QWidget, QProgressBar, QLabel, QFrame, QVBoxLayout, QPushButton, \\\n    QStackedWidget\n\nfrom launcherui import MainWindow\nfrom static import resource_path, BACKUP_PATH, BACKUP_FILE_NAME\n\n# Suppress ssl warnings for sharepoint api calls\nurllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\n\n# Light theme colors matching the reference design\nCOLORS = {\n    'background_light': '#f8f9fa',\n    'surface_light': '#ffffff',\n    'border_light': '#dee2e6',\n    'primary': '#495057',\n    'text_dark': '#495057',\n    'text_medium': '#6c757d',\n    'progress_bg': '#e9ecef',\n    'progress_fill': '#8B4513',\n}\n\n\ndef fetch_cost_centers(site):\n    \"\"\"\n    Fetch cost centers from SharePoint list.\n    \"\"\"\n    try:\n        # sp_list = site.List(COST_CENTER)\n        # sp_data = sp_list.GetListItems(view_name=None)\n        # df = pd.DataFrame(sp_data)\n        # df.fillna(value='', inplace=True)\n        df = pd.read_csv(\"cost_center.csv\")\n        return df\n    except Exception as e:\n        print(f'Error fetching cost centers: {str(e)}')\n        return pd.DataFrame(columns=['cost_center_code', 'cost_center_name', 'is_gfbm'])\n\n\ndef fetch_user_data(site):\n    \"\"\"\n    Fetch user data from SharePoint list.\n    \"\"\"\n    try:\n        # sp_list = site.List(USERBASE)\n        # query = {'Where': [('Contains', 'sid', user_main)]}\n        # sp_data = sp_list.GetListItems(query=query)\n        # df = pd.DataFrame(sp_data)\n        # df.fillna(value='', inplace=True)\n        df = pd.read_csv(\"users.csv\")\n        return df\n    except Exception as e:\n        print(f'Error fetching user data: {str(e)}')\n        return pd.DataFrame(columns=['sid', 'display_name', 'email', 'job_title', 'building_name', 'cost_center_id'])\n\n\nclass DataLoader(QThread):\n    \"\"\"\n    DataLoader threaded class which loads the data from sharepoint while keeping UI live.\n    \"\"\"\n    progress_updated = pyqtSignal(int, str)\n    data_loaded = pyqtSignal(object, object, object)\n    error_occurred = pyqtSignal(str)\n\n    def __init__(self):\n        super().__init__()\n\n    def run(self):\n        \"\"\"\n        Default run function for threaded processing\n        \"\"\"\n        try:\n            # os.makedirs(name=f\"{os.environ.get('LOCALAPPDATA')}/{BACKUP_PATH}\", exist_ok=True)\n            #\n            # user = getpass.getuser()\n            # user = user.lower()\n            #\n            # # SharePoint client initialization\n            # self.progress_updated.emit(5, \"Initializing connection...\")\n            # cred = HttpNtlmAuth(SID, password='')\n            #\n            # self.progress_updated.emit(15, \"Connecting to SharePoint...\")\n            # site = Site(SITE_URL, auth=cred, verify_ssl=False)\n            #\n            # self.progress_updated.emit(35, \"Fetching application data...\")\n            # sp_list = site.List(SHAREPOINT_LIST)\n            # sp_data = sp_list.GetListItems(view_name=None)\n            # df_all = pd.DataFrame(sp_data)\n            self.progress_updated.emit(10, \"starting load...\")\n            sleep(2)\n            processed_df = pd.read_csv(\"application.csv\")\n            # df_all.fillna(value='', inplace=True)\n            # df_all['SIDs_For_SolutionAccess'] = df_all['SIDs_For_SolutionAccess'].str.lower()\n            # df_all.fillna(value='', inplace=True)\n            # all_df = df_all[df_all['SIDs_For_SolutionAccess'].str.contains('everyone', na=False)]\n            # processed_df = df_all[df_all['SIDs_For_SolutionAccess'].str.contains(user, na=False)]\n\n            # self.progress_updated.emit(60, \"Processing user access...\")\n            # processed_df = pd.concat([all_df, processed_df])\n\n            self.progress_updated.emit(75, \"Saving local backup...\")\n            processed_df.reset_index(inplace=True)\n            # processed_df.to_excel(excel_writer=f\"{os.environ.get('LOCALAPPDATA')}/{BACKUP_PATH}/{BACKUP_FILE_NAME}\",\n            #                       index=False)\n\n            self.progress_updated.emit(85, \"Loading additional data...\")\n            cc = fetch_cost_centers(\"site\")\n            user_data = fetch_user_data(\"site\")\n\n            self.progress_updated.emit(100, \"Loading complete!\")\n            self.data_loaded.emit(processed_df, cc, user_data)\n\n        except Exception as e:\n            error_msg = f'Error loading data: {str(e)}'\n            print(error_msg)\n            self.error_occurred.emit(\"Failed to connect to SharePoint. Loading from backup...\")\n\n            if os.path.exists(f\"{os.environ.get('LOCALAPPDATA')}/{BACKUP_PATH}/{BACKUP_FILE_NAME}\"):\n                processed_df = pd.read_excel(f\"{os.environ.get('LOCALAPPDATA')}/{BACKUP_PATH}/{BACKUP_FILE_NAME}\")\n                self.progress_updated.emit(100, \"Loaded from backup\")\n                self.data_loaded.emit(processed_df, pd.DataFrame(), pd.DataFrame())\n            else:\n                processed_df = pd.DataFrame(\n                    columns=['Expired', 'Solution_Name', 'Description', 'ApplicationExePath', 'Status', 'Release_Date',\n                             'Validity_Period', 'Version_Number', 'UMAT_IAHub_ID'])\n                self.error_occurred.emit(\"No backup data available. Please check your connection.\")\n                self.data_loaded.emit(processed_df, pd.DataFrame(), pd.DataFrame())\n\n\nclass LoadingScreen(QWidget):\n    \"\"\"Loading screen widget matching the reference design\"\"\"\n\n    def __init__(self, parent=None):\n        super().__init__(parent)\n        self.can_cancel = False\n        self.initUI()\n\n    def initUI(self):\n        # Main layout fills the entire window with light background\n        self.setStyleSheet(f\"background-color: {COLORS['background_light']};\")\n        layout = QVBoxLayout(self)\n        layout.setContentsMargins(0, 0, 0, 0)\n        layout.setAlignment(Qt.AlignmentFlag.AlignCenter)\n\n        # Center container\n        container = QFrame()\n        container.setFixedSize(500, 300)\n        container.setStyleSheet(f\"\"\"\n            QFrame {{\n                background-color: transparent;\n                border: none;\n            }}\n        \"\"\")\n        layout.addWidget(container, alignment=Qt.AlignmentFlag.AlignCenter)\n\n        container_layout = QVBoxLayout(container)\n        container_layout.setContentsMargins(0, 0, 0, 0)\n        container_layout.setSpacing(30)\n        container_layout.setAlignment(Qt.AlignmentFlag.AlignCenter)\n\n        # PSLV Title - large and prominent\n        self.titleLabel = QLabel(\"PSLV\")\n        self.titleLabel.setStyleSheet(f\"\"\"\n            font-size: 48px;\n            font-weight: bold;\n            color: {COLORS['primary']};\n            font-family: Arial, sans-serif;\n            border: none;\n        \"\"\")\n        self.titleLabel.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        container_layout.addWidget(self.titleLabel)\n\n        # Subtitle\n        self.subtitleLabel = QLabel(\"Python Solution Launcher for VDI\")\n        self.subtitleLabel.setStyleSheet(f\"\"\"\n            font-size: 16px;\n            color: {COLORS['text_medium']};\n            font-family: Arial, sans-serif;\n            font-weight: normal;\n            border: none;\n        \"\"\")\n        self.subtitleLabel.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        container_layout.addWidget(self.subtitleLabel)\n\n        # Loading status label - this shows \"loading applications......\"\n        self.labelLoading = QLabel('loading applications......')\n        self.labelLoading.setStyleSheet(f\"\"\"\n            font-size: 12px;\n            color: {COLORS['text_medium']};\n            font-family: Arial, sans-serif;\n            font-weight: normal;\n            border: none;\n        \"\"\")\n        self.labelLoading.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        container_layout.addWidget(self.labelLoading)\n\n        # Progress bar with brown fill matching the reference\n        self.progressBar = QProgressBar()\n        self.progressBar.setStyleSheet(f\"\"\"\n            QProgressBar {{\n                border: none;\n                border-radius: 4px;\n                background-color: {COLORS['progress_bg']};\n                height: 8px;\n                text-align: center;\n            }}\n            QProgressBar::chunk {{\n                background-color: {COLORS['progress_fill']};\n                border-radius: 4px;\n            }}\n        \"\"\")\n        self.progressBar.setTextVisible(False)\n        self.progressBar.setRange(0, 100)\n        self.progressBar.setValue(0)\n        self.progressBar.setFixedHeight(8)\n        self.progressBar.setFixedWidth(400)\n        container_layout.addWidget(self.progressBar, alignment=Qt.AlignmentFlag.AlignCenter)\n\n        # Bottom branding section\n        bottom_frame = QWidget()\n        bottom_layout = QVBoxLayout(bottom_frame)\n        bottom_layout.setContentsMargins(40, 0, 40, 40)\n        \n        # Create horizontal layout for bottom credits\n        credits_layout = QVBoxLayout()\n        credits_layout.setSpacing(20)\n        \n        # Developer credit - bottom left\n        dev_label = QLabel(\"Designed & developed by GF&BM STO team\")\n        dev_label.setStyleSheet(f\"\"\"\n            font-size: 10px;\n            color: {COLORS['text_medium']};\n            font-family: Arial, sans-serif;\n            border: none;\n        \"\"\")\n        dev_label.setAlignment(Qt.AlignmentFlag.AlignLeft)\n        credits_layout.addWidget(dev_label)\n        \n        # Company branding - bottom right\n        company_label = QLabel(\"JPMorganChase\")\n        company_label.setStyleSheet(f\"\"\"\n            font-size: 12px;\n            font-weight: bold;\n            color: {COLORS['primary']};\n            font-family: Arial, sans-serif;\n            border: none;\n        \"\"\")\n        company_label.setAlignment(Qt.AlignmentFlag.AlignRight)\n        credits_layout.addWidget(company_label)\n        \n        bottom_layout.addLayout(credits_layout)\n        \n        # Position bottom frame at the bottom of the main layout\n        layout.addStretch()\n        layout.addWidget(bottom_frame)\n\n    def updateProgress(self, value, task_name=\"loading applications......\"):\n        \"\"\"Update progress bar with real task feedback\"\"\"\n        self.progressBar.setValue(value)\n        # Keep the main loading text consistent with reference\n        self.labelLoading.setText(\"loading applications......\")\n\n    def onError(self, error_message):\n        \"\"\"Handle error messages\"\"\"\n        self.labelLoading.setText(error_message)\n        self.labelLoading.setStyleSheet(f\"\"\"\n            font-size: 12px;\n            color: #dc3545;\n            font-family: Arial, sans-serif;\n            font-weight: normal;\n            border: none;\n        \"\"\")\n\n\nclass MainWindowWidget(QWidget):\n    \"\"\"Wrapper widget for MainWindow content\"\"\"\n\n    def __init__(self, data, cost_centers, user_data):\n        super().__init__()\n\n        # Create the main window instance\n        self.main_window = MainWindow(data, cost_centers, user_data)\n\n        # Extract the central widget content\n        main_content = self.main_window.centralWidget()\n\n        # Create layout for this widget\n        layout = QVBoxLayout(self)\n        layout.setContentsMargins(0, 0, 0, 0)\n        layout.addWidget(main_content)\n\n        # Apply the same styling as MainWindow\n        self.setStyleSheet(f\"\"\"\n            QWidget {{\n                background-color: {COLORS['background_light']};\n                font-family: Arial, sans-serif;\n            }}\n        \"\"\")\n\n\nclass ApplicationWindow(QMainWindow):\n    \"\"\"Single window that transitions from loading screen to main application\"\"\"\n\n    def __init__(self):\n        super().__init__()\n        icon_path = resource_path(f\"/images/photo1762418937.jpg\")\n        self.setWindowIcon(QIcon(icon_path))\n        self.setWindowTitle('PSLV')\n\n        # Set fixed size for both loading and main application - same size throughout\n        self.setFixedSize(1400, 800)\n\n        # Center the window on screen from the start\n        screen_geometry = self.screen().geometry()\n        x = (screen_geometry.width() - self.width()) // 2\n        y = (screen_geometry.height() - self.height()) // 2\n        self.move(x, y)\n\n        # Apply light theme\n        self.setStyleSheet(f\"\"\"\n            QMainWindow {{\n                background-color: {COLORS['background_light']};\n                font-family: Arial, sans-serif;\n            }}\n        \"\"\")\n\n        # Create stacked widget to switch between loading and main app\n        self.stacked_widget = QStackedWidget()\n        self.setCentralWidget(self.stacked_widget)\n\n        # Create and add loading screen\n        self.loading_screen = LoadingScreen()\n        self.stacked_widget.addWidget(self.loading_screen)\n\n        # Initialize data loader\n        self.initDataLoader()\n\n        # Main window widget placeholder\n        self.main_window_widget = None\n\n    def initDataLoader(self):\n        \"\"\"Initialize data loader thread\"\"\"\n        self.data_loader = DataLoader()\n        self.data_loader.progress_updated.connect(self.loading_screen.updateProgress)\n        self.data_loader.data_loaded.connect(self.onDataLoaded)\n        self.data_loader.error_occurred.connect(self.loading_screen.onError)\n        self.data_loader.start()\n\n    def onDataLoaded(self, data, cost_centers, user_data):\n        \"\"\"Handle data loaded signal and transition to main application\"\"\"\n        self.loading_screen.progressBar.setValue(100)\n\n        # Small delay before transitioning\n        QTimer.singleShot(1000, lambda: self.showMainApplication(data, cost_centers, user_data))\n\n    def showMainApplication(self, data, cost_centers, user_data):\n        \"\"\"Transition from loading screen to main application\"\"\"\n        # Create main window content as a widget\n        self.main_window_widget = MainWindowWidget(data, cost_centers, user_data)\n\n        # Add to stacked widget\n        self.stacked_widget.addWidget(self.main_window_widget)\n\n        # Switch to main application (no resizing needed - same size throughout)\n        self.stacked_widget.setCurrentWidget(self.main_window_widget)\n\n        # Update window title\n        self.setWindowTitle('PSLV by STD, GF&BM India')\n\n\nif __name__ == '__main__':\n    app = QApplication(sys.argv)\n\n    # Set application-wide stylesheet for light theme\n    app.setStyleSheet(f\"\"\"\n        * {{\n            font-family: Arial, sans-serif;\n        }}\n    \"\"\")\n\n    window = ApplicationWindow()\n    window.show()\n\n    try:\n        sys.exit(app.exec())\n    except SystemExit:\n        print('Closing Window...')"
  },
  {
    "type": "xhr",
    "startTime": 67996.70000000298,
    "method": "GET",
    "url": "/api/v1/files/download?path=%2Fchats%2Fb42fab31a6264b18b0390a285edfed19%2Fworkspace%2Flauncherui.py",
    "status": 200,
    "endTime": 68346.20000000298,
    "duration": 349.5,
    "responseText": "\"\"\"\nSolution Launcher Window - Updated UI\n================================================================================\nThis Module contains the updated code with light theme UI matching the new design.\n\"\"\"\n\nimport datetime\n# Python default package imports\nimport getpass\nimport os\nimport shutil\nfrom datetime import datetime\n\n# Python third party package imports\n# import awmpy\nimport pandas as pd\nimport timedelta\nimport urllib3\nfrom PyQt6.QtCore import Qt, QThread, pyqtSignal, QUrl, QTimer\nfrom PyQt6.QtGui import QIcon, QDesktopServices\nfrom PyQt6.QtWidgets import (QMainWindow, QWidget, QVBoxLayout, QHBoxLayout,\n                             QPushButton, QLabel, QLineEdit, QGridLayout, QFrame, QProgressBar, QScrollArea,\n                             QStackedLayout, QMenu, QStackedWidget, QDialog, QButtonGroup)\nfrom requests_ntlm import HttpNtlmAuth\nfrom shareplum import Site\n\n# User created module for functionalities\nfrom access import AccessControlDialog\nfrom security_check import LauncherSecurity\nfrom static import resource_path, APP_DIR, expire_sort, DETAILS, SITE_URL, SID, SHAREPOINT_LIST, \\\n    BACKUP_FILE_NAME, BACKUP_PATH, ADMIN, add_new_user_to_userbase\n\n# global variable for user id\nuser_main = getpass.getuser()\n\n# Updated Light Theme Colors - matching the reference design\nCOLORS = {\n    'background_light': '#f8f9fa',\n    'surface_light': '#ffffff',\n    'sidebar_brown': '#8B4513',\n    'sidebar_gradient': '#A0522D',\n    'tile_background': '#ffffff',\n    'tile_hover': '#f5f5f5',\n    'border_light': '#dee2e6',\n    'border_dark': '#adb5bd',\n    'primary': '#007acc',\n    'text_dark': '#495057',\n    'text_medium': '#6c757d',\n    'text_light': '#ffffff',\n    'uat_bg': '#6f42c1',\n    'uat_text': '#ffffff',\n    'beta_bg': '#007acc',\n    'beta_text': '#ffffff',\n    'prod_bg': '#28a745',\n    'prod_text': '#ffffff',\n    'green_status': '#28a745',\n    'red_status': '#dc3545',\n    'progress_bg': '#e9ecef',\n    'progress_fill': '#8B4513',\n}\n\n\nclass EnvironmentLabel(QLabel):\n    \"\"\"Environment badge with proper contrast for light theme\"\"\"\n\n    def __init__(self, env_type, parent=None):\n        if len(env_type) > 4:\n            env_type = env_type[:4]\n        super().__init__(env_type, parent)\n        self.env_type = env_type\n        self.setAlignment(Qt.AlignmentFlag.AlignCenter)\n\n        # Color scheme for environment badges matching reference\n        if env_type == \"PROD\":\n            bg_color = COLORS['prod_bg']\n            text_color = COLORS['prod_text']\n        elif env_type == \"UAT\":\n            bg_color = COLORS['uat_bg']\n            text_color = COLORS['uat_text']\n        else:  # BETA\n            bg_color = COLORS['beta_bg']\n            text_color = COLORS['beta_text']\n\n        self.setStyleSheet(f\"\"\"\n            background-color: {bg_color};\n            color: {text_color};\n            border-radius: 10px;\n            padding: 3px 8px;\n            font-size: 9px;\n            font-weight: bold;\n            font-family: Arial, sans-serif;\n            border: none;\n        \"\"\")\n        self.setFixedHeight(18)\n        self.setFixedWidth(45)\n\n\nclass InstallThread(QThread):\n    \"\"\"Thread for handling installation\"\"\"\n\n    progress = pyqtSignal(int)\n    finished = pyqtSignal()\n    error = pyqtSignal(str)\n\n    def __init__(self, source, destination):\n        super().__init__()\n        self.source = source\n        self.destination = destination\n\n    def run(self):\n        try:\n            if not os.path.exists(self.source):\n                raise FileNotFoundError(f\"Source file not found: {self.source}\")\n\n            total_size = os.path.getsize(self.source)\n            copied_size = 0\n            with open(self.source, 'rb') as src, open(self.destination, 'wb') as dst:\n                while True:\n                    chunk = src.read(1024)\n                    if not chunk:\n                        break\n                    dst.write(chunk)\n                    copied_size += len(chunk)\n                    progress = int((copied_size / total_size) * 100)\n                    self.progress.emit(progress)\n            self.finished.emit()\n        except FileNotFoundError as e:\n            self.error.emit(str(e))\n        except Exception as e:\n            self.error.emit(f\"Installation error: {str(e)}\")\n\n\n# Custom MessageBox with light theme styling\nclass CustomMessageBox(QDialog):\n    \"\"\"Custom message box with light theme and proper contrast\"\"\"\n\n    def __init__(self, parent=None, title=\"\", message=\"\", icon_type=\"info\"):\n        super().__init__(parent)\n        self.setWindowFlags(Qt.WindowType.Dialog | Qt.WindowType.FramelessWindowHint)\n        self.setModal(True)\n        self.setupUI(title, message, icon_type)\n\n        # Center on parent\n        if parent:\n            QTimer.singleShot(0, self.center_on_parent_delayed)\n        else:\n            self.center_on_screen()\n\n    def setupUI(self, title, message, icon_type):\n        # Dynamic sizing based on content\n        base_width = 450\n        base_height = 200\n\n        # Calculate height based on message length and line breaks\n        line_count = message.count('\\n') + 1\n        if len(message) > 100:\n            line_count += len(message) // 50\n\n        # Adjust height based on content\n        content_height = max(base_height, 150 + (line_count * 20))\n        if title:\n            content_height += 30\n\n        self.setFixedSize(base_width, content_height)\n        self.setStyleSheet(f\"\"\"\n            QDialog {{\n                background-color: {COLORS['surface_light']};\n                border: 2px solid {COLORS['border_light']};\n                border-radius: 12px;\n            }}\n        \"\"\")\n\n        layout = QVBoxLayout(self)\n        layout.setContentsMargins(24, 24, 24, 24)\n        layout.setSpacing(16)\n\n        # Icon and title\n        if icon_type == \"error\":\n            icon_text = \"âŒ\"\n            title_color = COLORS['red_status']\n        elif icon_type == \"warning\":\n            icon_text = \"âš ï¸\"\n            title_color = COLORS['uat_bg']\n        elif icon_type == \"info\":\n            icon_text = \"â„¹ï¸\"\n            title_color = COLORS['primary']\n        else:\n            icon_text = \"âœ…\"\n            title_color = COLORS['green_status']\n\n        icon_label = QLabel(icon_text)\n        icon_label.setStyleSheet(\"font-size: 32px; border: none;\")\n        icon_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        layout.addWidget(icon_label)\n\n        # Title\n        if title:\n            title_label = QLabel(title)\n            title_label.setStyleSheet(f\"\"\"\n                font-size: 18px;\n                font-weight: bold;\n                color: {title_color};\n                font-family: Arial, sans-serif;\n                border: none;\n                margin: 0px;\n                padding: 0px;\n            \"\"\")\n            title_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\n            title_label.setWordWrap(True)\n            layout.addWidget(title_label)\n\n        # Message with proper contrast for light theme\n        message_label = QLabel(message)\n        message_label.setStyleSheet(f\"\"\"\n            font-size: 14px;\n            color: {COLORS['text_dark']};\n            font-family: Arial, sans-serif;\n            border: none;\n            margin: 0px;\n            padding: 8px;\n            background-color: transparent;\n            line-height: 1.4;\n        \"\"\")\n        message_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        message_label.setWordWrap(True)\n        message_label.setMinimumHeight(50)\n        message_label.adjustSize()\n        layout.addWidget(message_label)\n\n        # Add stretch to push button to bottom\n        layout.addStretch()\n\n        # Buttons\n        button_layout = QHBoxLayout()\n        button_layout.setSpacing(12)\n\n        ok_button = QPushButton(\"OK\")\n        ok_button.clicked.connect(self.accept)\n        ok_button.setStyleSheet(f\"\"\"\n            QPushButton {{\n                background-color: {COLORS['primary']};\n                color: white;\n                border: none;\n                padding: 10px 20px;\n                border-radius: 6px;\n                font-weight: 600;\n                font-size: 13px;\n                font-family: Arial, sans-serif;\n                min-width: 80px;\n            }}\n            QPushButton:hover {{\n                background-color: #0056b3;\n            }}\n        \"\"\")\n\n        button_layout.addStretch()\n        button_layout.addWidget(ok_button)\n        button_layout.addStretch()\n        layout.addLayout(button_layout)\n\n    def center_on_parent_delayed(self):\n        \"\"\"Delayed centering with proper geometry validation\"\"\"\n        if self.parent():\n            parent = self.parent()\n            if hasattr(parent, 'isVisible') and parent.isVisible():\n                parent_rect = parent.geometry()\n                x = parent_rect.x() + (parent_rect.width() - self.width()) // 2\n                y = parent_rect.y() + (parent_rect.height() - self.height()) // 2\n                self.move(x, y)\n            else:\n                QTimer.singleShot(50, self.center_on_parent_delayed)\n        else:\n            self.center_on_screen()\n\n    def center_on_screen(self):\n        \"\"\"Center the dialog on screen\"\"\"\n        screen = self.screen().geometry() if self.screen() else None\n        if screen:\n            x = (screen.width() - self.width()) // 2\n            y = (screen.height() - self.height()) // 2\n            self.move(x, y)\n\n\nclass ApplicationTile(QFrame):\n    \"\"\"Modern application tile with light theme\"\"\"\n\n    def __init__(self, app_name, app_description, shared_drive_path, environment,\n                 release_date, validity_period, version_number, registration_id, parent=None):\n        super().__init__(parent)\n\n        # Store all the data\n        self.app_name = app_name\n        self.app_description = app_description\n        self.shared_drive_path = shared_drive_path\n        self.environment = environment\n        self.release_date = release_date\n        self.validity_period = validity_period\n        self.version_number = version_number\n        self.registration_id = registration_id\n\n        # Set up paths\n        self.install_path = os.environ.get('USERPROFILE')\n        self.install_path = os.path.join(f\"{self.install_path}\\\\{APP_DIR}\", app_name)\n\n        # Initialize version tracking\n        self.installed_version = self.get_installed_version()\n        self.installed = self.is_app_installed(f\"{self.install_path}\" + \"\\\\\" + f\"{self.app_name}.exe\")\n\n        # Check status\n        self.is_expired = self.check_validity()\n        self.update_available = self.check_update_available()\n\n        # Initialize flip state\n        self.is_flipped = False\n\n        # Create both sides\n        self.front_widget = QWidget()\n        self.back_widget = QWidget()\n        self.stacked_layout = QStackedLayout(self)\n\n        self.setup_front_ui()\n        self.setup_back_ui()\n\n        self.stacked_layout.addWidget(self.front_widget)\n        self.stacked_layout.addWidget(self.back_widget)\n\n        # Set context menu\n        self.setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)\n        self.customContextMenuRequested.connect(self.show_context_menu)\n\n        # Better sizing and styling for light theme\n        self.setFixedHeight(200)\n        self.setFixedWidth(300)\n        self.setup_styles()\n\n        # Add overlay if expired\n        if self.is_expired:\n            self.add_expired_overlay()\n\n    def setup_styles(self):\n        \"\"\"Apply light theme styling with proper contrast\"\"\"\n        self.setStyleSheet(f\"\"\"\n            ApplicationTile {{\n                background-color: {COLORS['tile_background']};\n                border-radius: 12px;\n                border: 1px solid {COLORS['border_light']};\n                margin: 2px;\n            }}\n            ApplicationTile:hover {{\n                background-color: {COLORS['tile_hover']};\n                border: 1px solid {COLORS['primary']};\n            }}\n        \"\"\")\n\n    def setup_front_ui(self):\n        \"\"\"Setup front side with proper spacing for light theme\"\"\"\n        layout = QVBoxLayout(self.front_widget)\n        layout.setContentsMargins(16, 16, 16, 16)\n        layout.setSpacing(12)\n\n        # Apply consistent background styling\n        self.front_widget.setStyleSheet(f\"\"\"\n            QWidget {{\n                background-color: transparent;\n                border: none;\n            }}\n        \"\"\")\n\n        # Header with proper spacing\n        header_layout = QHBoxLayout()\n        header_layout.setSpacing(8)\n        header_layout.setContentsMargins(0, 0, 0, 0)\n\n        self.env_label = EnvironmentLabel(self.environment)\n        header_layout.addWidget(self.env_label)\n        header_layout.addStretch()\n\n        # Status indicator with light theme styling\n        self.status_indicator = QLabel(\"Not Installed\")\n        self.status_indicator.setStyleSheet(f\"\"\"\n            color: {COLORS['text_medium']};\n            font-size: 10px;\n            font-weight: 600;\n            font-family: Arial, sans-serif;\n            border: none;\n            padding: 0px;\n        \"\"\")\n        header_layout.addWidget(self.status_indicator)\n        layout.addLayout(header_layout)\n\n        # App name with better sizing\n        self.name_label = QLabel(self.app_name)\n        self.name_label.setStyleSheet(f\"\"\"\n            font-weight: 700;\n            font-size: 16px;\n            color: {COLORS['text_dark']};\n            font-family: Arial, sans-serif;\n            margin: 0px;\n            padding: 0px;\n            border: none;\n        \"\"\")\n        self.name_label.setWordWrap(True)\n        self.name_label.setMaximumHeight(40)\n        layout.addWidget(self.name_label)\n\n        # Description with controlled height\n        self.description_label = QLabel(self.app_description.strip())\n        self.description_label.setWordWrap(True)\n        self.description_label.setFixedHeight(35)\n        self.description_label.setAlignment(Qt.AlignmentFlag.AlignLeft | Qt.AlignmentFlag.AlignTop)\n        self.description_label.setStyleSheet(f\"\"\"\n            color: {COLORS['text_medium']};\n            font-size: 11px;\n            font-family: Arial, sans-serif;\n            line-height: 1.3;\n            border: none;\n            padding: 0px;\n            margin: 0px;\n        \"\"\")\n        layout.addWidget(self.description_label)\n\n        # Add stretch to push buttons to bottom\n        layout.addStretch()\n\n        # Progress bar with light theme\n        self.progress_bar = QProgressBar()\n        self.progress_bar.setVisible(False)\n        self.progress_bar.setTextVisible(False)\n        self.progress_bar.setStyleSheet(f\"\"\"\n            QProgressBar {{\n                border: none;\n                border-radius: 4px;\n                background-color: {COLORS['progress_bg']};\n                height: 8px;\n                margin: 4px 0px;\n            }}\n            QProgressBar::chunk {{\n                background-color: {COLORS['progress_fill']};\n                border-radius: 4px;\n            }}\n        \"\"\")\n        layout.addWidget(self.progress_bar)\n\n        # Buttons with better layout and spacing\n        button_layout = QHBoxLayout()\n        button_layout.setSpacing(8)\n        button_layout.setContentsMargins(0, 0, 0, 0)\n\n        self.install_launch_button = QPushButton(\"Install\")\n        self.install_launch_button.clicked.connect(self.on_install_launch_clicked)\n        self.install_launch_button.setStyleSheet(f\"\"\"\n            QPushButton {{\n                background-color: {COLORS['sidebar_brown']};\n                color: white;\n                border: none;\n                padding: 8px 12px;\n                border-radius: 6px;\n                font-weight: 600;\n                font-size: 11px;\n                font-family: Arial, sans-serif;\n                min-width: 60px;\n                max-height: 28px;\n            }}\n            QPushButton:hover {{\n                background-color: {COLORS['sidebar_gradient']};\n            }}\n            QPushButton:pressed {{\n                background-color: #654321;\n            }}\n            QPushButton:disabled {{\n                background-color: {COLORS['border_dark']};\n                color: {COLORS['text_medium']};\n            }}\n        \"\"\")\n\n        self.uninstall_button = QPushButton(\"Uninstall\")\n        self.uninstall_button.setEnabled(True)\n        self.uninstall_button.clicked.connect(self.on_uninstall_clicked)\n        self.uninstall_button.setStyleSheet(f\"\"\"\n            QPushButton {{\n                background-color: {COLORS['border_dark']};\n                color: {COLORS['text_dark']};\n                border: none;\n                padding: 8px 12px;\n                border-radius: 6px;\n                font-weight: 600;\n                font-size: 11px;\n                font-family: Arial, sans-serif;\n                min-width: 60px;\n                max-height: 28px;\n            }}\n            QPushButton:hover {{\n                background-color: #868e96;\n            }}\n            QPushButton:pressed {{\n                background-color: #6c757d;\n            }}\n            QPushButton:disabled {{\n                background-color: {COLORS['progress_bg']};\n                color: {COLORS['text_medium']};\n            }}\n        \"\"\")\n\n        button_layout.addWidget(self.install_launch_button)\n        button_layout.addWidget(self.uninstall_button)\n        layout.addLayout(button_layout)\n\n        # Update initial button states\n        if self.is_app_installed(f'{self.install_path}.exe'):\n            self.installed = True\n            self.uninstall_button.setEnabled(True)\n        self.update_button_states()\n\n    def setup_back_ui(self):\n        \"\"\"Setup back side with proper spacing for light theme\"\"\"\n        main_layout = QVBoxLayout(self.back_widget)\n        main_layout.setContentsMargins(16, 16, 16, 16)\n        main_layout.setSpacing(12)\n\n        # Apply consistent background styling\n        self.back_widget.setStyleSheet(f\"\"\"\n            QWidget {{\n                background-color: transparent;\n                border: none;\n            }}\n        \"\"\")\n\n        # Title with proper spacing\n        title_label = QLabel(\"Application Details\")\n        title_label.setStyleSheet(f\"\"\"\n            font-size: 14px;\n            font-weight: bold;\n            color: {COLORS['text_dark']};\n            font-family: Arial, sans-serif;\n            margin-bottom: 8px;\n            border: none;\n            padding: 0px;\n        \"\"\")\n        main_layout.addWidget(title_label)\n\n        # Details with controlled spacing\n        details = [\n            (\"IAHub ID\", \"Not Registered\" if pd.isna(self.registration_id) else str(self.registration_id)),\n            (\"Release Date\", str(pd.Timestamp(self.release_date))[:10] if self.release_date else \"N/A\"),\n            (\"Version\", str(self.version_number) if self.version_number else \"1.0\"),\n            (\"Status\", \"Expired\" if self.is_expired else \"Active\")\n        ]\n\n        for title, value in details:\n            # Each detail in its own container with controlled height\n            detail_container = QWidget()\n            detail_container.setStyleSheet(\"border: none;\")\n            detail_container.setFixedHeight(35)\n            detail_layout = QVBoxLayout(detail_container)\n            detail_layout.setSpacing(2)\n            detail_layout.setContentsMargins(0, 2, 0, 2)\n\n            title_label = QLabel(title)\n            title_label.setStyleSheet(f\"\"\"\n                color: {COLORS['text_medium']};\n                font-size: 9px;\n                font-weight: 500;\n                font-family: Arial, sans-serif;\n                border: none;\n                padding: 0px;\n                margin: 0px;\n            \"\"\")\n            detail_layout.addWidget(title_label)\n\n            value_label = QLabel(str(value))\n            value_label.setStyleSheet(f\"\"\"\n                color: {COLORS['text_dark']};\n                font-size: 11px;\n                font-weight: 600;\n                font-family: Arial, sans-serif;\n                border: none;\n                padding: 0px;\n                margin: 0px;\n            \"\"\")\n            value_label.setWordWrap(True)\n            value_label.setMaximumHeight(20)\n            detail_layout.addWidget(value_label)\n\n            main_layout.addWidget(detail_container)\n\n        main_layout.addStretch()\n\n    def show_context_menu(self, position):\n        \"\"\"Show context menu for flipping\"\"\"\n        context_menu = QMenu(self)\n        context_menu.setStyleSheet(f\"\"\"\n            QMenu {{\n                background-color: {COLORS['surface_light']};\n                border: 1px solid {COLORS['border_light']};\n                border-radius: 6px;\n                padding: 4px;\n            }}\n            QMenu::item {{\n                padding: 6px 12px;\n                border-radius: 4px;\n                color: {COLORS['text_dark']};\n                border: none;\n            }}\n            QMenu::item:selected {{\n                background-color: {COLORS['primary']};\n                color: white;\n            }}\n        \"\"\")\n\n        flip_action = context_menu.addAction(\"Show Details\" if not self.is_flipped else \"Show Main\")\n        action = context_menu.exec(self.mapToGlobal(position))\n        if action == flip_action:\n            self.flip_tile()\n\n    def flip_tile(self):\n        \"\"\"Flip the tile\"\"\"\n        self.is_flipped = not self.is_flipped\n        self.stacked_layout.setCurrentIndex(1 if self.is_flipped else 0)\n\n    def add_expired_overlay(self):\n        \"\"\"Add expired overlay\"\"\"\n        self.overlay = QWidget(self)\n        self.overlay.setStyleSheet(\"\"\"\n            background-color: rgba(0, 0, 0, 0.6);\n            border-radius: 12px;\n            border: none;\n        \"\"\")\n        self.overlay.setGeometry(self.rect())\n        self.overlay.show()\n        self.front_widget.setEnabled(False)\n\n    # Keep all the original methods for functionality\n    def on_install_launch_clicked(self):\n        if self.update_available:\n            self.update_application()\n        elif not self.installed:\n            self.install_application()\n        else:\n            self.launch_application()\n\n    def is_app_installed(self, local_path):\n        return os.path.exists(local_path)\n\n    def install_application(self):\n        # Better UI feedback during installation\n        self.progress_bar.setVisible(True)\n        self.status_indicator.setText(\"Installing...\")\n        self.install_launch_button.setEnabled(False)\n\n        os.makedirs(self.install_path, exist_ok=True)\n        destination_file = os.path.join(self.install_path, f\"{self.app_name}.exe\")\n\n        self.install_thread = InstallThread(self.shared_drive_path, destination_file)\n        self.install_thread.progress.connect(self.update_progress)\n        self.install_thread.finished.connect(self.installation_finished)\n        self.install_thread.error.connect(self.installation_error)\n        self.install_thread.start()\n\n    def installation_error(self, error_message):\n        self.progress_bar.setVisible(False)\n        self.status_indicator.setText(\"Installation Failed\")\n        self.install_launch_button.setEnabled(True)\n\n        # Use custom message box with proper contrast\n        dialog = CustomMessageBox(\n            parent=self.window(),\n            title=\"Installation Error\",\n            message=f\"Failed to install {self.app_name}:\\n{error_message}\",\n            icon_type=\"error\"\n        )\n        dialog.exec()\n\n    def update_progress(self, value):\n        self.progress_bar.setValue(value)\n\n    def installation_finished(self):\n        self.installed = True\n        self.save_installed_version()\n        self.installed_version = self.version_number\n        self.update_available = False\n        self.update_button_states()\n        self.progress_bar.setVisible(False)\n        self.install_launch_button.setEnabled(True)\n\n        # Use custom message box\n        dialog = CustomMessageBox(\n            parent=self.window(),\n            title=\"Installation Complete\",\n            message=f\"{self.app_name} has been successfully installed.\",\n            icon_type=\"success\"\n        )\n        dialog.exec()\n\n    def launch_application(self):\n        # pslv_action_entry([{'SID': user_main, 'action': f'Launched {self.app_name}'}])\n        executable_path = os.path.join(self.install_path, f\"{self.app_name}.exe\")\n        release_date = pd.Timestamp(self.release_date)\n        expiry_date = release_date + timedelta(days=self.validity_period)\n        days_remaining = expiry_date - datetime.now()\n        if os.path.exists(executable_path):\n            try:\n                if pd.isna(self.registration_id) and self.environment == 'BETA':\n                    # Use custom message box\n                    dialog = CustomMessageBox(\n                        parent=self.window(),\n                        title=\"Action Required\",\n                        message=f'Application is not registered at IA Hub and will stop working in {days_remaining.days} days.',\n                        icon_type=\"warning\"\n                    )\n                    dialog.exec()\n                LauncherSecurity.generate_launch_token(executable_path)\n                os.startfile(executable_path)\n            except Exception as e:\n                # Use custom message box\n                dialog = CustomMessageBox(\n                    parent=self.window(),\n                    title=\"Error\",\n                    message=f'Failed to launch application: {str(e)}',\n                    icon_type=\"error\"\n                )\n                dialog.exec()\n        else:\n            # Use custom message box\n            dialog = CustomMessageBox(\n                parent=self.window(),\n                title=\"Error\",\n                message=f'Application executable not found at {executable_path}',\n                icon_type=\"error\"\n            )\n            dialog.exec()\n\n    def on_uninstall_clicked(self):\n        if self.installed:\n            try:\n                shutil.rmtree(self.install_path)\n                self.installed = False\n                self.status_indicator.setText(\"Not Installed\")\n                self.install_launch_button.setText(\"Install\")\n                # pslv_action_entry([{'SID': user_main, 'action': f'Uninstalled {self.app_name}'}])\n\n                # Use custom message box\n                dialog = CustomMessageBox(\n                    parent=self.window(),\n                    title=\"Uninstall Complete\",\n                    message=f'{self.app_name} has been successfully uninstalled.',\n                    icon_type=\"success\"\n                )\n                dialog.exec()\n            except Exception as e:\n                # Use custom message box\n                dialog = CustomMessageBox(\n                    parent=self.window(),\n                    title=\"Uninstall Error\",\n                    message=f'Failed to uninstall {self.app_name}: {str(e)}',\n                    icon_type=\"error\"\n                )\n                dialog.exec()\n\n    def check_validity(self):\n        try:\n            # release_date = pd.Timestamp(self.release_date)\n            # expiry_date = release_date + timedelta(days=self.validity_period)\n            # return datetime.now() > expiry_date\n            return False\n        except Exception as e:\n            print(f\"Error checking validity: {str(e)}\")\n            return False\n\n    def check_update_available(self):\n        try:\n            installed_version = self.get_installed_version()\n            if self.version_number and self.installed:\n                if installed_version is None:\n                    return True\n                return float(self.version_number) > float(installed_version)\n            return False\n        except Exception as e:\n            print(f\"Error checking for updates: {str(e)}\")\n            return False\n\n    def update_button_states(self):\n        if self.is_expired:\n            self.status_indicator.setText(\"Expired\")\n            self.status_indicator.setStyleSheet(\n                f\"color: {COLORS['red_status']}; font-size: 10px; font-weight: 600; border: none; padding: 0px;\")\n            self.install_launch_button.setEnabled(False)\n            self.uninstall_button.setEnabled(False)\n            return\n        if self.update_available:\n            self.install_launch_button.setText(\"Update\")\n            self.status_indicator.setText(\"Update Available\")\n            self.status_indicator.setStyleSheet(\n                f\"color: {COLORS['uat_bg']}; font-size: 10px; font-weight: 600; border: none; padding: 0px;\")\n        elif self.installed:\n            self.install_launch_button.setText(\"Launch\")\n            self.status_indicator.setText(\"Installed\")\n            self.status_indicator.setStyleSheet(\n                f\"color: {COLORS['green_status']}; font-size: 10px; font-weight: 600; border: none; padding: 0px;\")\n        else:\n            self.install_launch_button.setText(\"Install\")\n            self.status_indicator.setText(\"Not Installed\")\n            self.status_indicator.setStyleSheet(\n                f\"color: {COLORS['text_medium']}; font-size: 10px; font-weight: 600; border: none; padding: 0px;\")\n\n    def get_installed_version(self):\n        version_file = os.path.join(self.install_path, \"version.txt\")\n        if os.path.exists(version_file):\n            try:\n                with open(version_file, 'r') as f:\n                    return float(f.read().strip())\n            except:\n                return None\n        return None\n\n    def save_installed_version(self):\n        try:\n            os.makedirs(self.install_path, exist_ok=True)\n            version_file = os.path.join(self.install_path, \"version.txt\")\n            with open(version_file, 'w') as f:\n                f.write(str(self.version_number))\n        except Exception as e:\n            print(f\"Error saving version info: {str(e)}\")\n\n    def update_application(self):\n        latest_version = self.version_number\n        if latest_version:\n            try:\n                if os.path.exists(self.install_path):\n                    shutil.rmtree(self.install_path)\n\n                self.install_application()\n                self.version_number = latest_version\n                self.update_available = False\n                self.update_button_states()\n            except Exception as e:\n                # Use custom message box\n                dialog = CustomMessageBox(\n                    parent=self.window(),\n                    title=\"Update Error\",\n                    message=f\"Failed to update {self.app_name}: {str(e)}\",\n                    icon_type=\"error\"\n                )\n                dialog.exec()\n\n\nclass NoAccessWidget(QWidget):\n    \"\"\"Compact no access widget with light theme\"\"\"\n\n    def __init__(self, is_gfbm_user):\n        super().__init__()\n        self.is_gfbm_user = is_gfbm_user\n        self.setupUI()\n\n    def setupUI(self):\n        # Set a maximum size for the widget to prevent over-expansion\n        self.setMaximumSize(500, 350)\n        self.setMinimumSize(500, 350)\n\n        # Main layout with no margins to keep it compact\n        main_layout = QVBoxLayout(self)\n        main_layout.setContentsMargins(0, 0, 0, 0)\n        main_layout.setSpacing(0)\n\n        # Create the message container with exact sizing\n        container = QFrame()\n        container.setFixedSize(500, 350)\n        container.setStyleSheet(f\"\"\"\n            QFrame {{\n                background-color: {COLORS['surface_light']};\n                border-radius: 12px;\n                border: 1px solid {COLORS['border_light']};\n            }}\n        \"\"\")\n\n        # Container layout with proper spacing\n        container_layout = QVBoxLayout(container)\n        container_layout.setContentsMargins(32, 32, 32, 32)\n        container_layout.setSpacing(16)\n        container_layout.setAlignment(Qt.AlignmentFlag.AlignCenter)\n\n        # Icon\n        icon_label = QLabel(\"ðŸš«\")\n        icon_label.setStyleSheet(f\"\"\"\n            font-size: 48px;\n            color: {COLORS['red_status']};\n            border: none;\n        \"\"\")\n        icon_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        container_layout.addWidget(icon_label)\n\n        # Title with proper styling\n        title_label = QLabel(\"No Application Access\")\n        title_label.setStyleSheet(f\"\"\"\n            font-size: 20px;\n            font-weight: bold;\n            color: {COLORS['text_dark']};\n            font-family: Arial, sans-serif;\n            border: none;\n            margin: 0px;\n            padding: 0px;\n        \"\"\")\n        title_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        container_layout.addWidget(title_label)\n\n        # Description with proper line breaks and styling\n        description_text = (\"Currently, you do not have access to any application.\\n\"\n                          \"Please contact administrator for access permissions.\")\n        if not self.is_gfbm_user:\n            description_text = (\"Thanks for showing your interest for PSLV.\\n\"\n                              \"At present, Application is accessible for Global Finance & Business Management India.\")\n\n        description_label = QLabel(description_text)\n        description_label.setStyleSheet(f\"\"\"\n            font-size: 13px;\n            color: {COLORS['text_medium']};\n            font-family: Arial, sans-serif;\n            border: none;\n            line-height: 2;\n            margin: 0px;\n            padding: 0px;\n        \"\"\")\n        description_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        description_label.setWordWrap(True)\n        container_layout.addWidget(description_label)\n\n        # Add some spacing\n        container_layout.addSpacing(8)\n\n        # Help Center button with proper styling\n        help_button = QPushButton(\"Help Center\")\n        help_button.setStyleSheet(f\"\"\"\n            QPushButton {{\n                background-color: {COLORS['primary']};\n                color: white;\n                border: none;\n                padding: 10px 24px;\n                border-radius: 6px;\n                font-weight: 600;\n                font-size: 13px;\n                font-family: Arial, sans-serif;\n                min-width: 120px;\n                max-width: 160px;\n            }}\n            QPushButton:hover {{\n                background-color: #0056b3;\n            }}\n            QPushButton:pressed {{\n                background-color: #004085;\n            }}\n        \"\"\")\n        help_button.clicked.connect(self.contact_admin)\n        container_layout.addWidget(help_button, alignment=Qt.AlignmentFlag.AlignCenter)\n\n        # Add the container to main layout\n        main_layout.addWidget(container)\n\n    def contact_admin(self):\n        \"\"\"Open help center URL\"\"\"\n        support_url = QUrl(\n            \"https://confluence.prod.aws.jpmchase.net/confluence/spaces/GFITECH/pages/5228999093/APPLICATION+OWNER+AND+ADMINS\")\n        QDesktopServices.openUrl(support_url)\n\n\nclass MainWindow(QMainWindow):\n    \"\"\"Main window with light theme matching the reference design\"\"\"\n\n    def __init__(self, df, cost_center, userdata):\n        super().__init__()\n        self.all_tiles = []\n        self.access = df\n        self.cost_center_df = cost_center\n        self.userdata = userdata\n        self.user_details = self.get_user_details()\n        self.is_gfbm_user = self.is_gfbm_user_check()\n        self.username = user_main\n        self.current_filter = \"All\"\n\n        self.setWindowTitle(\"PSLV by STD, GF&BM India\")\n        icon_path = resource_path(f\"/images/Logo.jpg\")\n        self.setWindowIcon(QIcon(icon_path))\n        self.setFixedSize(1400, 800)\n\n        # Apply light theme\n        self.setStyleSheet(f\"\"\"\n            QMainWindow {{\n                background-color: {COLORS['background_light']};\n                font-family: Arial, sans-serif;\n                border: none;\n            }}\n        \"\"\")\n\n        central_widget = QWidget()\n        self.setCentralWidget(central_widget)\n        main_layout = QHBoxLayout(central_widget)\n        main_layout.setSpacing(0)\n        main_layout.setContentsMargins(0, 0, 0, 0)\n\n        # Sidebar\n        sidebar = self.create_sidebar()\n        main_layout.addWidget(sidebar)\n\n        # Main content area\n        content_area = QWidget()\n        content_layout = QVBoxLayout(content_area)\n        content_layout.setContentsMargins(32, 32, 32, 32)\n        content_layout.setSpacing(24)\n\n        # Header with title and filters\n        header_layout = QHBoxLayout()\n\n        title_label = QLabel(\"Applications\")\n        title_label.setStyleSheet(f\"\"\"\n            font-size: 28px;\n            font-weight: bold;\n            color: {COLORS['text_dark']};\n            font-family: Arial, sans-serif;\n            border: none;\n        \"\"\")\n        header_layout.addWidget(title_label)\n        header_layout.addStretch()\n\n        # Filter buttons\n        filter_container = QWidget()\n        filter_layout = QHBoxLayout(filter_container)\n        filter_layout.setSpacing(8)\n        filter_layout.setContentsMargins(0, 0, 0, 0)\n\n        self.filter_group = QButtonGroup()\n        filter_buttons = [\"All\", \"PROD\", \"BETA\", \"UAT\"]\n\n        for idx, filter_name in enumerate(filter_buttons):\n            btn = QPushButton(filter_name)\n            btn.setCheckable(True)\n            btn.setChecked(filter_name == \"All\")\n            btn.clicked.connect(lambda checked, f=filter_name: self.apply_filter(f))\n            self.filter_group.addButton(btn, idx)\n\n            if filter_name == \"All\":\n                btn.setStyleSheet(f\"\"\"\n                    QPushButton {{\n                        background-color: {COLORS['primary']};\n                        color: white;\n                        border: none;\n                        padding: 8px 16px;\n                        border-radius: 8px;\n                        font-weight: 600;\n                        font-size: 13px;\n                        font-family: Arial, sans-serif;\n                    }}\n                    QPushButton:checked {{\n                        background-color: {COLORS['primary']};\n                    }}\n                    QPushButton:hover {{\n                        background-color: #0056b3;\n                    }}\n                \"\"\")\n            else:\n                btn.setStyleSheet(f\"\"\"\n                    QPushButton {{\n                        background-color: {COLORS['progress_bg']};\n                        color: {COLORS['text_medium']};\n                        border: none;\n                        padding: 8px 16px;\n                        border-radius: 8px;\n                        font-weight: 600;\n                        font-size: 13px;\n                        font-family: Arial, sans-serif;\n                    }}\n                    QPushButton:checked {{\n                        background-color: {COLORS['primary']};\n                        color: white;\n                    }}\n                    QPushButton:hover {{\n                        background-color: {COLORS['border_light']};\n                        color: {COLORS['text_dark']};\n                    }}\n                \"\"\")\n\n            filter_layout.addWidget(btn)\n\n        header_layout.addWidget(filter_container)\n\n        # Search bar\n        self.search_bar = QLineEdit()\n        self.search_bar.setPlaceholderText(\"ðŸ” Search applications...\")\n        self.search_bar.textChanged.connect(self.filter_applications)\n        self.search_bar.setStyleSheet(f\"\"\"\n            QLineEdit {{\n                background-color: {COLORS['surface_light']};\n                border: 2px solid {COLORS['border_light']};\n                border-radius: 8px;\n                padding: 12px 16px 12px 40px;\n                color: {COLORS['text_dark']};\n                font-size: 14px;\n                min-width: 280px;\n                font-family: Arial, sans-serif;\n            }}\n            QLineEdit:focus {{\n                border: 2px solid {COLORS['primary']};\n            }}\n            QLineEdit::placeholder {{\n                color: {COLORS['text_medium']};\n            }}\n        \"\"\")\n        header_layout.addWidget(self.search_bar)\n        \n        # Refresh button\n        self.refresh_button = QPushButton(\"âŸ²\")\n        self.refresh_button.setCursor(Qt.CursorShape.PointingHandCursor)\n        self.refresh_button.setToolTip(\"âŸ² Refresh Applications\")\n        self.refresh_button.clicked.connect(self.refresh_applications)\n        self.refresh_button.setStyleSheet(f\"\"\"\n            QPushButton {{\n                background-color: transparent;\n                color: {COLORS['text_dark']};\n                font-size: 20px;\n                padding: 5px;\n                min-width: 30px;\n                font-weight: bold;\n                border: none;\n            }}\n            QPushButton:hover {{\n                color: {COLORS['primary']};\n            }}\n        \"\"\")\n        header_layout.addWidget(self.refresh_button)\n\n        content_layout.addLayout(header_layout)\n\n        # Scroll area for applications\n        scroll_area = QScrollArea()\n        scroll_area.setWidgetResizable(True)\n        scroll_area.setHorizontalScrollBarPolicy(Qt.ScrollBarPolicy.ScrollBarAlwaysOff)\n        scroll_area.setStyleSheet(f\"\"\"\n            QScrollArea {{\n                border: none;\n                background-color: transparent;\n            }}\n            QScrollBar:vertical {{\n                border: none;\n                background: {COLORS['progress_bg']};\n                width: 8px;\n                border-radius: 4px;\n            }}\n            QScrollBar::handle:vertical {{\n                background: {COLORS['border_dark']};\n                border-radius: 4px;\n            }}\n            QScrollBar::handle:vertical:hover {{\n                background: {COLORS['text_medium']};\n            }}\n        \"\"\")\n\n        scroll_content = QWidget()\n        self.app_grid = QGridLayout(scroll_content)\n        self.app_grid.setSpacing(16)\n        self.app_grid.setAlignment(Qt.AlignmentFlag.AlignTop | Qt.AlignmentFlag.AlignLeft)\n        scroll_area.setWidget(scroll_content)\n\n        self.search_app = QWidget()\n        self.search_app_layout = QVBoxLayout(self.search_app)\n        self.search_app_layout.addWidget(scroll_area)\n\n        # Create stacked widget\n        self.stacked_widget = QStackedWidget()\n        self.stacked_widget.addWidget(self.search_app)\n\n        # Access control widget (if admin)\n        if self.is_administrator():\n            self.access_control_widget = AccessControlDialog(self.username, [])\n            self.stacked_widget.addWidget(self.access_control_widget)\n\n        content_layout.addWidget(self.stacked_widget)\n        \n        # JPMorganChase branding\n        brand_frame = tk.Frame(content_area, bg='#f8f9fa')\n        brand_frame.pack(side='bottom', anchor='se', padx=30, pady=20)\n        \n        brand_label = QLabel(\"JPMorganChase\")\n        brand_label.setStyleSheet(f\"\"\"\n            font-size: 12px;\n            font-weight: bold;\n            color: {COLORS['text_medium']};\n            font-family: Arial, sans-serif;\n            border: none;\n        \"\"\")\n        content_layout.addWidget(brand_label, alignment=Qt.AlignmentFlag.AlignBottom | Qt.AlignmentFlag.AlignRight)\n        \n        main_layout.addWidget(content_area)\n\n        # Load applications\n        if len(self.access) != 0 and self.is_gfbm_user:\n            self.load_applications()\n        else:\n            # Clear the grid and add NoAccessWidget properly centered\n            self.clear_layout(self.app_grid)\n            # Center the NoAccessWidget in the middle of the content area\n            self.app_grid.setAlignment(Qt.AlignmentFlag.AlignCenter)\n            no_access_widget = NoAccessWidget(self.is_gfbm_user)\n            # Add the widget to the center of the grid with proper alignment\n            self.app_grid.addWidget(no_access_widget, 0, 0, 1, 1, Qt.AlignmentFlag.AlignCenter)\n\n    def create_sidebar(self):\n        \"\"\"Create sidebar with brown theme matching reference\"\"\"\n        sidebar = QWidget()\n        sidebar.setFixedWidth(280)\n        sidebar.setStyleSheet(f\"\"\"\n            QWidget {{\n                background-color: {COLORS['sidebar_brown']};\n                border: none;\n            }}\n        \"\"\")\n\n        layout = QVBoxLayout(sidebar)\n        layout.setContentsMargins(24, 24, 24, 24)\n        layout.setSpacing(16)\n\n        # Company branding\n        brand_frame = QWidget()\n        brand_layout = QVBoxLayout(brand_frame)\n        brand_layout.setContentsMargins(0, 0, 0, 0)\n        brand_layout.setSpacing(5)\n        \n        brand_label1 = QLabel(\"GF&BM INDIA\")\n        brand_label1.setStyleSheet(f\"\"\"\n            font-size: 16px;\n            font-weight: bold;\n            color: {COLORS['text_light']};\n            font-family: Arial, sans-serif;\n            border: none;\n        \"\"\")\n        brand_label1.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        brand_layout.addWidget(brand_label1)\n        \n        brand_label2 = QLabel(\"SMART SOLUTIONS\")\n        brand_label2.setStyleSheet(f\"\"\"\n            font-size: 12px;\n            color: {COLORS['text_light']};\n            font-family: Arial, sans-serif;\n            border: none;\n        \"\"\")\n        brand_label2.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        brand_layout.addWidget(brand_label2)\n        \n        layout.addWidget(brand_frame)\n\n        # User details\n        user_details = [\n            (\"ðŸ“‹\", \"Q772257\"),\n            (\"ðŸ‘¤\", \"Karan Mehta\"),\n            (\"âœ‰ï¸\", \"karan.mehta@\\njpmchase.com\"),\n            (\"ðŸ’¼\", \"Applied AI/ML Lead\"),\n            (\"ðŸ“\", \"JPMorgan Chase &\\ntowers, Mumbai\")\n        ]\n\n        for icon, text in user_details:\n            detail_widget = self.create_detail_widget(icon, text)\n            layout.addWidget(detail_widget)\n\n        layout.addStretch()\n\n        # Separator line\n        separator = QFrame()\n        separator.setFrameShape(QFrame.Shape.HLine)\n        separator.setStyleSheet(f\"background-color: {COLORS['text_light']}; height: 1px; border: none;\")\n        layout.addWidget(separator)\n\n        # Bottom buttons\n        button_container = QWidget()\n        button_layout = QVBoxLayout(button_container)\n        button_layout.setSpacing(8)\n        button_layout.setContentsMargins(0, 16, 0, 0)\n\n        # About button\n        about_btn = QPushButton(\"â“  About\")\n        about_btn.clicked.connect(self.show_about_dialog)\n        about_btn.setStyleSheet(self.get_sidebar_button_style())\n        button_layout.addWidget(about_btn)\n\n        # Help button\n        help_btn = QPushButton(\"â“  Help\")\n        help_btn.clicked.connect(self.show_help_dialog)\n        help_btn.setStyleSheet(self.get_sidebar_button_style())\n        button_layout.addWidget(help_btn)\n\n        # Exit button\n        exit_btn = QPushButton(\"ðŸšª  Exit\")\n        exit_btn.clicked.connect(self.close_application)\n        exit_btn.setStyleSheet(self.get_sidebar_button_style())\n        button_layout.addWidget(exit_btn)\n\n        layout.addWidget(button_container)\n\n        return sidebar\n\n    def close_application(self):\n        \"\"\"Properly close the application\"\"\"\n        self.close()\n\n    def get_sidebar_button_style(self):\n        return f\"\"\"\n            QPushButton {{\n                background-color: transparent;\n                color: {COLORS['text_light']};\n                border: none;\n                padding: 12px 16px;\n                border-radius: 8px;\n                text-align: left;\n                font-weight: 500;\n                font-family: Arial, sans-serif;\n            }}\n            QPushButton:hover {{\n                background-color: rgba(255, 255, 255, 0.1);\n            }}\n        \"\"\"\n\n    def create_detail_widget(self, icon, text):\n        \"\"\"Create widget for user details\"\"\"\n        container = QWidget()\n        layout = QHBoxLayout(container)\n        layout.setSpacing(10)\n        layout.setContentsMargins(0, 5, 0, 5)\n\n        icon_label = QLabel(icon)\n        icon_label.setStyleSheet(f\"\"\"\n            font-size: 16px;\n            color: {COLORS['text_light']};\n            border: none;\n            min-width: 20px;\n        \"\"\")\n        layout.addWidget(icon_label)\n\n        text_label = QLabel(text)\n        text_label.setStyleSheet(f\"\"\"\n            color: {COLORS['text_light']};\n            font-size: 11px;\n            font-family: Arial, sans-serif;\n            border: none;\n        \"\"\")\n        text_label.setWordWrap(True)\n        layout.addWidget(text_label)\n\n        return container\n\n    def show_about_dialog(self):\n        \"\"\"Show about dialog matching reference design\"\"\"\n        dialog = CustomMessageBox(\n            parent=self,\n            title=\"About PSLV\",\n            message=\"This launcher is a dedicated platform developed by the Strategic Transformation Office (STO) team within Global Finance & Business Management (GF&BM).\\n\\nIt is exclusively designed to provide access to solutions created by the STO team.\\n\\nPlease note, this launcher is not intended for use as an integrated development environment (IDE) or for Python application development.\",\n            icon_type=\"info\"\n        )\n        dialog.exec()\n\n    def show_help_dialog(self):\n        \"\"\"Show help dialog\"\"\"\n        help_text = (\"This is the PSLV Software Center.\\n\\n\"\n                     \"â€¢ Browse and install available applications\\n\"\n                     \"â€¢ Filter by environment (UAT, BETA, PROD)\\n\"\n                     \"â€¢ Search for specific applications\\n\"\n                     \"â€¢ Right-click tiles for more options\\n\\n\"\n                     \"For assistance, contact Think_STO@restricted.chase.com\")\n\n        dialog = CustomMessageBox(\n            parent=self,\n            title=\"Help\",\n            message=help_text,\n            icon_type=\"info\"\n        )\n        dialog.exec()\n\n    def apply_filter(self, filter_name):\n        \"\"\"Apply environment filter\"\"\"\n        self.current_filter = filter_name\n        self.update_grid_layout(self.search_bar.text().lower())\n\n        # Update button styles\n        for button in self.filter_group.buttons():\n            if button.text() == filter_name:\n                button.setStyleSheet(f\"\"\"\n                    QPushButton {{\n                        background-color: {COLORS['primary']};\n                        color: white;\n                        border: none;\n                        padding: 8px 16px;\n                        border-radius: 8px;\n                        font-weight: 600;\n                        font-size: 13px;\n                        font-family: Arial, sans-serif;\n                    }}\n                \"\"\")\n            else:\n                button.setStyleSheet(f\"\"\"\n                    QPushButton {{\n                        background-color: {COLORS['progress_bg']};\n                        color: {COLORS['text_medium']};\n                        border: none;\n                        padding: 8px 16px;\n                        border-radius: 8px;\n                        font-weight: 600;\n                        font-size: 13px;\n                        font-family: Arial, sans-serif;\n                    }}\n                    QPushButton:hover {{\n                        background-color: {COLORS['border_light']};\n                        color: {COLORS['text_dark']};\n                    }}\n                \"\"\")\n\n    def load_applications(self):\n        \"\"\"Load applications into grid\"\"\"\n        try:\n            self.clear_layout(self.app_grid)\n            self.app_grid.setContentsMargins(0, 0, 0, 0)\n            self.app_grid.setAlignment(Qt.AlignmentFlag.AlignTop | Qt.AlignmentFlag.AlignLeft)\n            self.all_tiles.clear()\n\n            self.access['Expired'] = self.access.apply(lambda row: expire_sort(row), axis=1)\n            self.access = self.access.sort_values(by=['Expired', 'Solution_Name'], ascending=[True, True])\n            self.access.reset_index(inplace=True, drop=True)\n\n            for i, row in self.access.iterrows():\n                tile = ApplicationTile(\n                    app_name=row['Solution_Name'],\n                    app_description=row['Description'],\n                    shared_drive_path=row['ApplicationExePath'],\n                    environment=row['Status'],\n                    release_date=row['Release_Date'],\n                    validity_period=row['Validity_Period'],\n                    version_number=float(row['Version_Number']) if row['Version_Number'] else 1.0,\n                    registration_id=row['UMAT_IAHub_ID']\n                )\n                self.all_tiles.append(tile)\n\n            self.update_grid_layout(\"\")\n        except Exception as e:\n            # Use custom message box\n            dialog = CustomMessageBox(\n                parent=self,\n                title=\"Error\",\n                message=f\"Failed to load applications: {str(e)}\",\n                icon_type=\"error\"\n            )\n            dialog.exec()\n\n    def filter_applications(self, text):\n        self.update_grid_layout(text.lower())\n\n    def update_grid_layout(self, filter_text):\n        \"\"\"Update grid with filtered tiles - 3 tiles per row matching reference\"\"\"\n        self.clear_layout(self.app_grid)\n\n        visible_tiles = [\n            tile for tile in self.all_tiles\n            if (filter_text in tile.app_name.lower()) and\n               (self.current_filter == \"All\" or tile.environment == self.current_filter)\n        ]\n\n        # 3 tiles per row matching the reference design\n        for i, tile in enumerate(visible_tiles):\n            row = i // 3\n            col = i % 3\n            self.app_grid.addWidget(tile, row, col)\n            tile.setVisible(True)\n\n        self.app_grid.setRowStretch(len(visible_tiles) // 3 + 1, 1)\n\n    def clear_layout(self, layout):\n        if layout is None:\n            return\n        while layout.count():\n            item = layout.takeAt(0)\n            if item.widget():\n                item.widget().setParent(None)\n\n    def get_user_details(self):\n        \"\"\"Get user details\"\"\"\n        try:\n            if self.userdata.empty:\n                data = {}  # awmpy.get_phonebook_data(user_main)\n                self.cost_center = data['costCenterID']\n                details = [\n                    (data['standardID'], 'icons8-id-50.png'),\n                    (data['nameFull'], '/images/User.jpg'),\n                    (data['email'], 'icons8-email-50.png'),\n                    (data['jobTitle'], 'icons8-new-job-50.png'),\n                    (data['buildingName'], '/images/Location.jpg')\n                ]\n                add_new_user_to_userbase(\n                    [data['standardID'], data['nameFull'], data['email'], data['jobTitle'], data['buildingName'],\n                     data['costCenterID']])\n            else:\n                self.cost_center = str(self.userdata['cost_center_id'].values[0])\n                details = [\n                    (self.userdata['sid'].values[0], 'icons8-id-50.png'),\n                    (self.userdata['display_name'].values[0], '/images/User.jpg'),\n                    (self.userdata['email'].values[0], 'icons8-email-50.png'),\n                    (self.userdata['job_title'].values[0], 'icons8-new-job-50.png'),\n                    (self.userdata['building_name'].values[0], '/images/Location.jpg')\n                ]\n        except:\n            details = DETAILS\n        return details\n\n    def is_administrator(self):\n        \"\"\"Check if user is administrator\"\"\"\n        try:\n            cred = HttpNtlmAuth(SID, password=\"**\")\n            site = Site(SITE_URL, auth=cred, verify_ssl=False)\n            sp_list = site.List(ADMIN)\n            query = {'Where': [('Contains', 'sid', user_main)]}\n            sp_data = sp_list.GetListItems(query=query)\n            df = pd.DataFrame(sp_data)\n            df.fillna(value='', inplace=True)\n            managed_lob = df['lob'].tolist()\n            return len(managed_lob) > 0\n        except:\n            return False\n\n    def is_gfbm_user_check(self):\n        \"\"\"Check if user is GFBM\"\"\"\n        self.cost_center_df['cost_center_code'] = self.cost_center_df['cost_center_code'].astype(str)\n        cc_column = self.cost_center_df['cost_center_code'].to_list()\n        return self.cost_center in cc_column\n\n    def refresh_applications(self):\n        \"\"\"Refresh applications list\"\"\"\n        self.search_bar.clear()\n        try:\n            user = user_main.lower()\n            urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\n            cred = HttpNtlmAuth(SID, password=\"**\")\n            site = Site(SITE_URL, auth=cred, verify_ssl=False)\n            sp_list = site.List(SHAREPOINT_LIST)\n            sp_data = sp_list.GetListItems(view_name=None)\n            df_all = pd.DataFrame(sp_data)\n            df_all.fillna(value='', inplace=True)\n            df_all['SIDs_For_SolutionAccess'] = df_all['SIDs_For_SolutionAccess'].str.lower()\n            all_df = df_all[df_all['SIDs_For_SolutionAccess'].str.contains('everyone', na=False)]\n            processed_df = df_all[df_all['SIDs_For_SolutionAccess'].str.contains(user, na=False)]\n            processed_df = pd.concat([all_df, processed_df])\n            processed_df.reset_index(inplace=True)\n        except Exception as e:\n            if os.path.exists(f\"{os.environ.get('USERPROFILE')}/{BACKUP_PATH}/{BACKUP_FILE_NAME}\"):\n                processed_df = pd.read_excel(f\"{os.environ.get('USERPROFILE')}/{BACKUP_PATH}/{BACKUP_FILE_NAME}\")\n            else:\n                processed_df = pd.DataFrame(\n                    columns=['Expired', 'Solution_Name', 'Description', 'ApplicationExePath', 'Status',\n                             'Release_Date', 'Validity_Period', 'Version_Number', 'UMAT_IAHub_ID'])\n\n        self.access = processed_df\n        if len(self.access) > 0:\n            self.load_applications()\n        else:\n            self.clear_layout(self.app_grid)\n            self.app_grid.setAlignment(Qt.AlignmentFlag.AlignCenter)\n            no_access_widget = NoAccessWidget(self.is_gfbm_user)\n            self.app_grid.addWidget(no_access_widget, 0, 0, 1, 1, Qt.AlignmentFlag.AlignCenter)\n\n            # Use custom message box\n            dialog = CustomMessageBox(\n                parent=self,\n                title=\"Application\",\n                message=\"Refresh Complete...\",\n                icon_type=\"info\"\n            )\n            dialog.exec()"
  }
]
