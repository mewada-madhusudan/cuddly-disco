elf,\n            title=\"About PSLV\",\n            message=\"This launcher is a dedicated platform developed by the Strategic Transformation Office (STO) team within Global Finance & Business Management (GF&BM).\\n\\nIt is exclusively designed to provide access to solutions created by the STO team.\\n\\nPlease note, this launcher is not intended for use as an integrated development environment (IDE) or for Python application development.\",\n            icon_type=\"info\"\n        )\n        dialog.exec()\n\n    def show_help_dialog(self):\n        \"\"\"Show help dialog\"\"\"\n        help_text = (\"This is the PSLV Software Center.\\n\\n\"\n                     \"‚Ä¢ Browse and install available applications\\n\"\n                     \"‚Ä¢ Filter by environment (UAT, BETA, PROD)\\n\"\n                     \"‚Ä¢ Search for specific applications\\n\"\n                     \"‚Ä¢ Right-click tiles for more options\\n\\n\"\n                     \"For assistance, contact Think_STO@restricted.chase.com\")\n\n        dialog = CustomMessageBox(\n            parent=self,\n            title=\"Help\",\n            message=help_text,\n            icon_type=\"info\"\n        )\n        dialog.exec()\n\n    def apply_filter(self, filter_name):\n        \"\"\"Apply environment filter\"\"\"\n        self.current_filter = filter_name\n        self.update_grid_layout(self.search_bar.text().lower())\n\n        # Update button styles\n        for button in self.filter_group.buttons():\n            if button.text() == filter_name:\n                button.setStyleSheet(f\"\"\"\n                    QPushButton {{\n                        background-color: {COLORS['primary']};\n                        color: white;\n                        border: none;\n                        padding: 8px 16px;\n                        border-radius: 8px;\n                        font-weight: 600;\n                        font-size: 13px;\n                        font-family: Arial, sans-serif;\n                    }}\n                \"\"\")\n            else:\n                button.setStyleSheet(f\"\"\"\n                    QPushButton {{\n                        background-color: {COLORS['progress_bg']};\n                        color: {COLORS['text_medium']};\n                        border: none;\n                        padding: 8px 16px;\n                        border-radius: 8px;\n                        font-weight: 600;\n                        font-size: 13px;\n                        font-family: Arial, sans-serif;\n                    }}\n                    QPushButton:hover {{\n                        background-color: {COLORS['border_light']};\n                        color: {COLORS['text_dark']};\n                    }}\n                \"\"\")\n\n    def load_applications(self):\n        \"\"\"Load applications into grid\"\"\"\n        try:\n            self.clear_layout(self.app_grid)\n            self.app_grid.setContentsMargins(0, 0, 0, 0)\n            self.app_grid.setAlignment(Qt.AlignmentFlag.AlignTop | Qt.AlignmentFlag.AlignLeft)\n            self.all_tiles.clear()\n\n            self.access['Expired'] = self.access.apply(lambda row: expire_sort(row), axis=1)\n            self.access = self.access.sort_values(by=['Expired', 'Solution_Name'], ascending=[True, True])\n            self.access.reset_index(inplace=True, drop=True)\n\n            for i, row in self.access.iterrows():\n                tile = ApplicationTile(\n                    app_name=row['Solution_Name'],\n                    app_description=row['Description'],\n                    shared_drive_path=row['ApplicationExePath'],\n                    environment=row['Status'],\n                    release_date=row['Release_Date'],\n                    validity_period=row['Validity_Period'],\n                    version_number=float(row['Version_Number']) if row['Version_Number'] else 1.0,\n                    registration_id=row['UMAT_IAHub_ID']\n                )\n                self.all_tiles.append(tile)\n\n            self.update_grid_layout(\"\")\n        except Exception as e:\n            # Use custom message box\n            dialog = CustomMessageBox(\n                parent=self,\n                title=\"Error\",\n                message=f\"Failed to load applications: {str(e)}\",\n                icon_type=\"error\"\n            )\n            dialog.exec()\n\n    def filter_applications(self, text):\n        self.update_grid_layout(text.lower())\n\n    def update_grid_layout(self, filter_text):\n        \"\"\"Update grid with filtered tiles - 3 tiles per row matching reference\"\"\"\n        self.clear_layout(self.app_grid)\n\n        visible_tiles = [\n            tile for tile in self.all_tiles\n            if (filter_text in tile.app_name.lower()) and\n               (self.current_filter == \"All\" or tile.environment == self.current_filter)\n        ]\n\n        # 3 tiles per row matching the reference design\n        for i, tile in enumerate(visible_tiles):\n            row = i // 3\n            col = i % 3\n            self.app_grid.addWidget(tile, row, col)\n            tile.setVisible(True)\n\n        self.app_grid.setRowStretch(len(visible_tiles) // 3 + 1, 1)\n\n    def clear_layout(self, layout):\n        if layout is None:\n            return\n        while layout.count():\n            item = layout.takeAt(0)\n            if item.widget():\n                item.widget().setParent(None)\n\n    def get_user_details(self):\n        \"\"\"Get user details\"\"\"\n        try:\n            if self.userdata.empty:\n                data = {}  # awmpy.get_phonebook_data(user_main)\n                self.cost_center = data['costCenterID']\n                details = [\n                    (data['standardID'], 'icons8-id-50.png'),\n                    (data['nameFull'], '/images/User.jpg'),\n                    (data['email'], 'icons8-email-50.png'),\n                    (data['jobTitle'], 'icons8-new-job-50.png'),\n                    (data['buildingName'], '/images/Location.jpg')\n                ]\n                add_new_user_to_userbase(\n                    [data['standardID'], data['nameFull'], data['email'], data['jobTitle'], data['buildingName'],\n                     data['costCenterID']])\n            else:\n                self.cost_center = str(self.userdata['cost_center_id'].values[0])\n                details = [\n                    (self.userdata['sid'].values[0], 'icons8-id-50.png'),\n                    (self.userdata['display_name'].values[0], '/images/User.jpg'),\n                    (self.userdata['email'].values[0], 'icons8-email-50.png'),\n                    (self.userdata['job_title'].values[0], 'icons8-new-job-50.png'),\n                    (self.userdata['building_name'].values[0], '/images/Location.jpg')\n                ]\n        except:\n            details = DETAILS\n        return details\n\n    def is_administrator(self):\n        \"\"\"Check if user is administrator\"\"\"\n        try:\n            cred = HttpNtlmAuth(SID, password=\"**\")\n            site = Site(SITE_URL, auth=cred, verify_ssl=False)\n            sp_list = site.List(ADMIN)\n            query = {'Where': [('Contains', 'sid', user_main)]}\n            sp_data = sp_list.GetListItems(query=query)\n            df = pd.DataFrame(sp_data)\n            df.fillna(value='', inplace=True)\n            managed_lob = df['lob'].tolist()\n            return len(managed_lob) > 0\n        except:\n            return False\n\n    def is_gfbm_user_check(self):\n        \"\"\"Check if user is GFBM\"\"\"\n        self.cost_center_df['cost_center_code'] = self.cost_center_df['cost_center_code'].astype(str)\n        cc_column = self.cost_center_df['cost_center_code'].to_list()\n        return self.cost_center in cc_column\n\n    def refresh_applications(self):\n        \"\"\"Refresh applications list\"\"\"\n        self.search_bar.clear()\n        try:\n            user = user_main.lower()\n            urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\n            cred = HttpNtlmAuth(SID, password=\"**\")\n            site = Site(SITE_URL, auth=cred, verify_ssl=False)\n            sp_list = site.List(SHAREPOINT_LIST)\n            sp_data = sp_list.GetListItems(view_name=None)\n            df_all = pd.DataFrame(sp_data)\n            df_all.fillna(value='', inplace=True)\n            df_all['SIDs_For_SolutionAccess'] = df_all['SIDs_For_SolutionAccess'].str.lower()\n            all_df = df_all[df_all['SIDs_For_SolutionAccess'].str.contains('everyone', na=False)]\n            processed_df = df_all[df_all['SIDs_For_SolutionAccess'].str.contains(user, na=False)]\n            processed_df = pd.concat([all_df, processed_df])\n            processed_df.reset_index(inplace=True)\n        except Exception as e:\n            if os.path.exists(f\"{os.environ.get('USERPROFILE')}/{BACKUP_PATH}/{BACKUP_FILE_NAME}\"):\n                processed_df = pd.read_excel(f\"{os.environ.get('USERPROFILE')}/{BACKUP_PATH}/{BACKUP_FILE_NAME}\")\n            else:\n                processed_df = pd.DataFrame(\n                    columns=['Expired', 'Solution_Name', 'Description', 'ApplicationExePath', 'Status',\n                             'Release_Date', 'Validity_Period', 'Version_Number', 'UMAT_IAHub_ID'])\n\n        self.access = processed_df\n        if len(self.access) > 0:\n            self.load_applications()\n        else:\n            self.clear_layout(self.app_grid)\n            self.app_grid.setAlignment(Qt.AlignmentFlag.AlignCenter)\n            no_access_widget = NoAccessWidget(self.is_gfbm_user)\n            self.app_grid.addWidget(no_access_widget, 0, 0, 1, 1, Qt.AlignmentFlag.AlignCenter)\n\n            # Use custom message box\n            dialog = CustomMessageBox(\n                parent=self,\n                title=\"Application\",\n                message=\"Refresh Complete...\",\n                icon_type=\"info\"\n            )\n            dialog.exec()"
[
  {
    "type": "xhr",
    "startTime": 108107.70000000298,
    "method": "GET",
    "url": "/api/v1/files/download?path=%2Fchats%2Fcae475b1e2824bb68b44486a3ae672dd%2Fworkspace%2Faccess.py",
    "status": 200,
    "endTime": 108475.40000000596,
    "duration": 367.70000000298023,
    "responseText": "\"\"\"\nAccess Control Dialog for PSLV Launcher\n\"\"\"\nfrom PyQt6.QtWidgets import QWidget, QVBoxLayout, QLabel\nfrom PyQt6.QtCore import Qt\n\nclass AccessControlDialog(QWidget):\n    \"\"\"Access control dialog widget\"\"\"\n    \n    def __init__(self, username, permissions):\n        super().__init__()\n        self.username = username\n        self.permissions = permissions\n        self.setupUI()\n    \n    def setupUI(self):\n        layout = QVBoxLayout(self)\n        \n        title = QLabel(\"Access Control\")\n        title.setStyleSheet(\"\"\"\n            font-size: 18px;\n            font-weight: bold;\n            color: #e6edf3;\n            margin: 20px;\n        \"\"\")\n        title.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        layout.addWidget(title)\n        \n        info = QLabel(f\"User: {self.username}\")\n        info.setStyleSheet(\"\"\"\n            font-size: 14px;\n            color: #c9d1d9;\n            margin: 10px;\n        \"\"\")\n        layout.addWidget(info)"
  },
  {
    "type": "xhr",
    "startTime": 109841.90000000596,
    "method": "GET",
    "url": "/api/v1/files/download?path=%2Fchats%2Fcae475b1e2824bb68b44486a3ae672dd%2Fworkspace%2FPSLV.py",
    "status": 200,
    "endTime": 110341.30000001192,
    "duration": 499.40000000596046,
    "responseText": "# PSLV SplashScreen launch node - Updated with Modern Dark Theme\n# =============================================================================\n# This module contains the updated starting code for PSLV Launcher with modern dark theme\n# Single window that transitions from loading screen to main application\n# ***\n\nimport os\nimport sys\nfrom time import sleep\n\nimport pandas as pd\nimport urllib3\nfrom PyQt6.QtCore import Qt, QThread, pyqtSignal, QTimer\nfrom PyQt6.QtGui import QIcon, QFont\nfrom PyQt6.QtWidgets import QApplication, QMainWindow, QWidget, QProgressBar, QLabel, QFrame, QVBoxLayout, QPushButton, \\\n    QStackedWidget\n\nfrom launcherui import MainWindow\nfrom static import resource_path, BACKUP_PATH, BACKUP_FILE_NAME\n\n# Suppress ssl warnings for sharepoint api calls\nurllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\n\nCOLORS = {\n    'background_dark': '#0d1117',\n    'surface_dark': '#161b22',\n    'border_dark': '#30363d',\n    'primary': '#238be6',\n    'text_light': '#f0f6fc',\n    'text_dark': '#8b949e',\n}\n\n\ndef fetch_cost_centers(site):\n    \"\"\"\n    Fetch cost centers from SharePoint list.\n    \"\"\"\n    try:\n        df = pd.read_csv(\"cost_center.csv\")\n        return df\n    except Exception as e:\n        print(f'Error fetching cost centers: {str(e)}')\n        return pd.DataFrame(columns=['cost_center_code', 'cost_center_name', 'is_gfbm'])\n\n\ndef fetch_user_data(site):\n    \"\"\"\n    Fetch user data from SharePoint list.\n    \"\"\"\n    try:\n        df = pd.read_csv(\"users.csv\")\n        return df\n    except Exception as e:\n        print(f'Error fetching user data: {str(e)}')\n        return pd.DataFrame(columns=['sid', 'display_name', 'email', 'job_title', 'building_name', 'cost_center_id'])\n\n\nclass DataLoader(QThread):\n    \"\"\"\n    DataLoader threaded class which loads the data from sharepoint while keeping UI live.\n    \"\"\"\n    progress_updated = pyqtSignal(int, str)\n    data_loaded = pyqtSignal(object, object, object)\n    error_occurred = pyqtSignal(str)\n\n    def __init__(self):\n        super().__init__()\n\n    def run(self):\n        \"\"\"\n        Default run function for threaded processing\n        \"\"\"\n        try:\n            self.progress_updated.emit(10, \"Initializing connection...\")\n            sleep(0.5)\n            \n            self.progress_updated.emit(25, \"Connecting to data source...\")\n            sleep(0.8)\n            \n            self.progress_updated.emit(45, \"Loading application data...\")\n            processed_df = pd.read_csv(\"application.csv\")\n            sleep(1.0)\n\n            self.progress_updated.emit(65, \"Processing user access...\")\n            processed_df.reset_index(inplace=True)\n            sleep(0.5)\n\n            self.progress_updated.emit(80, \"Loading additional data...\")\n            cc = fetch_cost_centers(\"site\")\n            user_data = fetch_user_data(\"site\")\n            sleep(0.5)\n\n            self.progress_updated.emit(100, \"Loading complete!\")\n            sleep(0.3)\n            self.data_loaded.emit(processed_df, cc, user_data)\n\n        except Exception as e:\n            error_msg = f'Error loading data: {str(e)}'\n            print(error_msg)\n            self.error_occurred.emit(\"Failed to connect to SharePoint. Loading from backup...\")\n\n            if os.path.exists(f\"{os.environ.get('LOCALAPPDATA')}/{BACKUP_PATH}/{BACKUP_FILE_NAME}\"):\n                processed_df = pd.read_excel(f\"{os.environ.get('LOCALAPPDATA')}/{BACKUP_PATH}/{BACKUP_FILE_NAME}\")\n                self.progress_updated.emit(100, \"Loaded from backup\")\n                self.data_loaded.emit(processed_df, pd.DataFrame(), pd.DataFrame())\n            else:\n                processed_df = pd.DataFrame(\n                    columns=['Expired', 'Solution_Name', 'Description', 'ApplicationExePath', 'Status', 'Release_Date',\n                             'Validity_Period', 'Version_Number', 'UMAT_IAHub_ID'])\n                self.error_occurred.emit(\"No backup data available. Please check your connection.\")\n                self.data_loaded.emit(processed_df, pd.DataFrame(), pd.DataFrame())\n\n\nclass LoadingScreen(QWidget):\n    \"\"\"Loading screen widget that matches the uploaded design\"\"\"\n\n    def __init__(self, parent=None):\n        super().__init__(parent)\n        self.can_cancel = False\n        self.initUI()\n\n    def initUI(self):\n        # Main layout fills the entire window\n        layout = QVBoxLayout(self)\n        layout.setContentsMargins(0, 0, 0, 0)\n        layout.setAlignment(Qt.AlignmentFlag.AlignCenter)\n\n        # Center container - larger to match the design\n        container = QFrame()\n        container.setFixedSize(500, 300)\n        container.setStyleSheet(f\"\"\"\n            QFrame {{\n                background-color: {COLORS['surface_dark']};\n                border: 1px solid {COLORS['border_dark']};\n                border-radius: 16px;\n            }}\n        \"\"\")\n        layout.addWidget(container, alignment=Qt.AlignmentFlag.AlignCenter)\n\n        container_layout = QVBoxLayout(container)\n        container_layout.setContentsMargins(40, 40, 40, 40)\n        container_layout.setSpacing(24)\n        container_layout.setAlignment(Qt.AlignmentFlag.AlignCenter)\n\n        # Logo/Icon area - larger and more prominent\n        self.iconLabel = QLabel(\"üöÄ\")\n        self.iconLabel.setStyleSheet(f\"\"\"\n            font-size: 64px;\n            color: {COLORS['primary']};\n            margin-bottom: 8px;\n        \"\"\")\n        self.iconLabel.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        container_layout.addWidget(self.iconLabel)\n\n        # Application title\n        title_label = QLabel('PSLV Software Center')\n        title_label.setStyleSheet(f\"\"\"\n            font-size: 24px;\n            color: {COLORS['text_light']};\n            font-family: Inter, sans-serif;\n            font-weight: 700;\n            margin-bottom: 8px;\n        \"\"\")\n        title_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        container_layout.addWidget(title_label)\n\n        # Loading status label\n        self.labelLoading = QLabel('Loading applications...')\n        self.labelLoading.setStyleSheet(f\"\"\"\n            font-size: 14px;\n            color: {COLORS['text_dark']};\n            font-family: Inter, sans-serif;\n            font-weight: 500;\n            margin-bottom: 16px;\n        \"\"\")\n        self.labelLoading.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        container_layout.addWidget(self.labelLoading)\n\n        # Progress bar with modern styling - wider to match design\n        self.progressBar = QProgressBar()\n        self.progressBar.setStyleSheet(f\"\"\"\n            QProgressBar {{\n                border: none;\n                border-radius: 6px;\n                background-color: {COLORS['border_dark']};\n                height: 8px;\n                text-align: center;\n            }}\n            QProgressBar::chunk {{\n                background-color: {COLORS['primary']};\n                border-radius: 6px;\n            }}\n        \"\"\")\n        self.progressBar.setTextVisible(False)\n        self.progressBar.setRange(0, 100)\n        self.progressBar.setValue(0)\n        self.progressBar.setFixedHeight(8)\n        self.progressBar.setFixedWidth(400)\n        container_layout.addWidget(self.progressBar, alignment=Qt.AlignmentFlag.AlignCenter)\n\n        # Progress percentage label\n        self.percentLabel = QLabel('0%')\n        self.percentLabel.setStyleSheet(f\"\"\"\n            font-size: 12px;\n            color: {COLORS['text_dark']};\n            font-family: Inter, sans-serif;\n            font-weight: 500;\n            margin-top: 8px;\n        \"\"\")\n        self.percentLabel.setAlignment(Qt.AlignmentFlag.AlignCenter)\n        container_layout.addWidget(self.percentLabel)\n\n    def updateProgress(self, value, task_name=\"Loading applications...\"):\n        \"\"\"Update progress bar with real task feedback\"\"\"\n        self.progressBar.setValue(value)\n        self.percentLabel.setText(f'{value}%')\n        \n        # Update the loading text to show current task\n        if value < 100:\n            self.labelLoading.setText(task_name)\n        else:\n            self.labelLoading.setText(\"Ready to launch!\")\n            self.labelLoading.setStyleSheet(f\"\"\"\n                font-size: 14px;\n                color: {COLORS['primary']};\n                font-family: Inter, sans-serif;\n                font-weight: 600;\n                margin-bottom: 16px;\n            \"\"\")\n\n    def onError(self, error_message):\n        \"\"\"Handle error messages\"\"\"\n        self.labelLoading.setText(error_message)\n        self.labelLoading.setStyleSheet(f\"\"\"\n            font-size: 14px;\n            color: #eab308;\n            font-family: Inter, sans-serif;\n            font-weight: 500;\n            margin-bottom: 16px;\n        \"\"\")\n\n\nclass MainWindowWidget(QWidget):\n    \"\"\"Wrapper widget for MainWindow content\"\"\"\n\n    def __init__(self, data, cost_centers, user_data):\n        super().__init__()\n\n        # Create the main window instance\n        self.main_window = MainWindow(data, cost_centers, user_data)\n\n        # Extract the central widget content\n        main_content = self.main_window.centralWidget()\n\n        # Create layout for this widget\n        layout = QVBoxLayout(self)\n        layout.setContentsMargins(0, 0, 0, 0)\n        layout.addWidget(main_content)\n\n        # Apply the same styling as MainWindow\n        self.setStyleSheet(f\"\"\"\n            QWidget {{\n                background-color: {COLORS['background_dark']};\n                font-family: Inter, sans-serif;\n            }}\n        \"\"\")\n\n\nclass ApplicationWindow(QMainWindow):\n    \"\"\"Single window that transitions from loading screen to main application\"\"\"\n\n    def __init__(self):\n        super().__init__()\n        try:\n            icon_path = resource_path(f\"/images/Logo.jpg\")\n            self.setWindowIcon(QIcon(icon_path))\n        except:\n            pass\n            \n        self.setWindowTitle('PSLV Software Center')\n\n        # Set fixed size for both loading and main application - same size throughout\n        self.setFixedSize(1400, 800)\n\n        # Center the window on screen from the start\n        screen_geometry = self.screen().geometry()\n        x = (screen_geometry.width() - self.width()) // 2\n        y = (screen_geometry.height() - self.height()) // 2\n        self.move(x, y)\n\n        # Apply dark theme\n        self.setStyleSheet(f\"\"\"\n            QMainWindow {{\n                background-color: {COLORS['background_dark']};\n                font-family: Inter, sans-serif;\n            }}\n        \"\"\")\n\n        # Create stacked widget to switch between loading and main app\n        self.stacked_widget = QStackedWidget()\n        self.setCentralWidget(self.stacked_widget)\n\n        # Create and add loading screen\n        self.loading_screen = LoadingScreen()\n        self.stacked_widget.addWidget(self.loading_screen)\n\n        # Initialize data loader\n        self.initDataLoader()\n\n        # Main window widget placeholder\n        self.main_window_widget = None\n\n    def initDataLoader(self):\n        \"\"\"Initialize data loader thread\"\"\"\n        self.data_loader = DataLoader()\n        self.data_loader.progress_updated.connect(self.loading_screen.updateProgress)\n        self.data_loader.data_loaded.connect(self.onDataLoaded)\n        self.data_loader.error_occurred.connect(self.loading_screen.onError)\n        self.data_loader.start()\n\n    def onDataLoaded(self, data, cost_centers, user_data):\n        \"\"\"Handle data loaded signal and transition to main application\"\"\"\n        self.loading_screen.progressBar.setValue(100)\n\n        # Small delay before transitioning\n        QTimer.singleShot(800, lambda: self.showMainApplication(data, cost_centers, user_data))\n\n    def showMainApplication(self, data, cost_centers, user_data):\n        \"\"\"Transition from loading screen to main application\"\"\"\n        # Create main window content as a widget\n        self.main_window_widget = MainWindowWidget(data, cost_centers, user_data)\n\n        # Add to stacked widget\n        self.stacked_widget.addWidget(self.main_window_widget)\n\n        # Switch to main application (no resizing needed - same size throughout)\n        self.stacked_widget.setCurrentWidget(self.main_window_widget)\n\n        # Update window title\n        self.setWindowTitle('PSLV by STD, GF&BM India')\n\n\nif __name__ == '__main__':\n    app = QApplication(sys.argv)\n\n    # Set application-wide stylesheet for modern dark theme\n    app.setStyleSheet(f\"\"\"\n        * {{\n            font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n        }}\n    \"\"\")\n\n    window = ApplicationWindow()\n    window.show()\n\n    try:\n        sys.exit(app.exec())\n    except SystemExit:\n        print('Closing Window...')"
  },
  {
    "type": "xhr",
    "startTime": 112005.5,
    "method": "GET",
    "url": "/api/v1/files/download?path=%2Fchats%2Fcae475b1e2824bb68b44486a3ae672dd%2Fworkspace%2Flauncherui.py",
    "status": 200,
    "endTime": 112548.10000000894,
    "duration": 542.6000000089407,
    "responseText": "\"\"\"\r\nSolution Launcher Window - Updated UI\r\n================================================================================\r\nThis Module contains the updated code with modern dark theme UI matching the new design.\r\n\"\"\"\r\n\r\nimport datetime\r\n# Python default package imports\r\nimport getpass\r\nimport os\r\nimport shutil\r\nfrom datetime import datetime\r\n\r\n# Python third party package imports\r\n# import awmpy\r\nimport pandas as pd\r\nimport timedelta\r\nimport urllib3\r\nfrom PyQt6.QtCore import Qt, QThread, pyqtSignal, QUrl, QTimer\r\nfrom PyQt6.QtGui import QIcon, QDesktopServices\r\nfrom PyQt6.QtWidgets import (QMainWindow, QWidget, QVBoxLayout, QHBoxLayout,\r\n                             QPushButton, QLabel, QLineEdit, QGridLayout, QFrame, QProgressBar, QScrollArea,\r\n                             QStackedLayout, QMenu, QStackedWidget, QDialog, QButtonGroup)\r\nfrom requests_ntlm import HttpNtlmAuth\r\nfrom shareplum import Site\r\n\r\n# User created module for functionalities\r\nfrom access import AccessControlDialog\r\nfrom security_check import LauncherSecurity\r\nfrom static import resource_path, APP_DIR, expire_sort, DETAILS, SITE_URL, SID, SHAREPOINT_LIST, \\\r\n    BACKUP_FILE_NAME, BACKUP_PATH, ADMIN, add_new_user_to_userbase\r\n\r\n# global variable for user id\r\nuser_main = getpass.getuser()\r\n\r\n# FIXED Modern Dark Theme Colors - Much stronger contrast and better visibility\r\nCOLORS = {\r\n    'background_dark': '#0d1117',\r\n    'surface_dark': '#161b22',\r\n    'tile_background': '#21262d',  # Better contrast - lighter than surface\r\n    'tile_hover': '#30363d',  # Even lighter for hover\r\n    'border_dark': '#30363d',\r\n    'border_light': '#484f58',\r\n    'primary': '#238be6',  # Slightly brighter blue\r\n    'text_light': '#f0f6fc',  # Brighter white\r\n    'text_medium': '#c9d1d9',  # Medium gray for better readability\r\n    'text_dark': '#8b949e',  # Darker gray for secondary text\r\n    'uat_bg': 'rgba(234, 179, 8, 0.2)',\r\n    'uat_text': '#eab308',\r\n    'beta_bg': 'rgba(59, 130, 246, 0.2)',\r\n    'beta_text': '#3b82f6',\r\n    'prod_bg': 'rgba(34, 197, 94, 0.2)',\r\n    'prod_text': '#22c55e',\r\n    'green_status': '#22c55e',\r\n    'red_status': '#ef4444',\r\n    'progress_bg': '#30363d',\r\n    'progress_fill': '#238be6',\r\n}\r\n\r\n\r\nclass EnvironmentLabel(QLabel):\r\n    \"\"\"FIXED environment badge with better contrast\"\"\"\r\n\r\n    def __init__(self, env_type, parent=None):\r\n        if len(env_type) > 4:\r\n            env_type = env_type[:4]\r\n        super().__init__(env_type, parent)\r\n        self.env_type = env_type\r\n        self.setAlignment(Qt.AlignmentFlag.AlignCenter)\r\n\r\n        # FIXED: Better color scheme for environment badges\r\n        if env_type == \"PROD\":\r\n            bg_color = COLORS['prod_text']\r\n            text_color = 'white'\r\n        elif env_type == \"UAT\":\r\n            bg_color = COLORS['uat_text']\r\n            text_color = 'white'\r\n        else:  # BETA\r\n            bg_color = COLORS['beta_text']\r\n            text_color = 'white'\r\n\r\n        self.setStyleSheet(f\"\"\"\r\n            background-color: {bg_color};\r\n            color: {text_color};\r\n            border-radius: 10px;\r\n            padding: 3px 8px;\r\n            font-size: 9px;\r\n            font-weight: bold;\r\n            font-family: Inter, sans-serif;\r\n            border: none;\r\n        \"\"\")\r\n        self.setFixedHeight(18)\r\n        self.setFixedWidth(45)\r\n\r\n\r\nclass InstallThread(QThread):\r\n    \"\"\"Thread for handling installation\"\"\"\r\n\r\n    progress = pyqtSignal(int)\r\n    finished = pyqtSignal()\r\n    error = pyqtSignal(str)\r\n\r\n    def __init__(self, source, destination):\r\n        super().__init__()\r\n        self.source = source\r\n        self.destination = destination\r\n\r\n    def run(self):\r\n        try:\r\n            if not os.path.exists(self.source):\r\n                raise FileNotFoundError(f\"Source file not found: {self.source}\")\r\n\r\n            total_size = os.path.getsize(self.source)\r\n            copied_size = 0\r\n            with open(self.source, 'rb') as src, open(self.destination, 'wb') as dst:\r\n                while True:\r\n                    chunk = src.read(1024)\r\n                    if not chunk:\r\n                        break\r\n                    dst.write(chunk)\r\n                    copied_size += len(chunk)\r\n                    progress = int((copied_size / total_size) * 100)\r\n                    self.progress.emit(progress)\r\n            self.finished.emit()\r\n        except FileNotFoundError as e:\r\n            self.error.emit(str(e))\r\n        except Exception as e:\r\n            self.error.emit(f\"Installation error: {str(e)}\")\r\n\r\n\r\n# FIXED: Custom MessageBox with proper styling and no title bar\r\nclass CustomMessageBox(QDialog):\r\n    \"\"\"Custom message box with no title bar, centered, and proper contrast\"\"\"\r\n\r\n    def __init__(self, parent=None, title=\"\", message=\"\", icon_type=\"info\"):\r\n        super().__init__(parent)\r\n        self.setWindowFlags(Qt.WindowType.Dialog | Qt.WindowType.FramelessWindowHint)\r\n        self.setModal(True)\r\n        self.setupUI(title, message, icon_type)\r\n\r\n        # FIXED: Delay the centering to ensure parent geometry is properly set\r\n        if parent:\r\n            # Use QTimer to delay centering until after the parent is fully rendered\r\n            QTimer.singleShot(0, self.center_on_parent_delayed)\r\n        else:\r\n            self.center_on_screen()\r\n\r\n    def setupUI(self, title, message, icon_type):\r\n        # FIXED: Dynamic sizing based on content\r\n        base_width = 450\r\n        base_height = 200\r\n\r\n        # Calculate height based on message length and line breaks\r\n        line_count = message.count('\\n') + 1\r\n        if len(message) > 100:\r\n            line_count += len(message) // 50  # Add lines for long text\r\n\r\n        # Adjust height based on content\r\n        content_height = max(base_height, 150 + (line_count * 20))\r\n        if title:\r\n            content_height += 30\r\n\r\n        self.setFixedSize(base_width, content_height)\r\n        self.setStyleSheet(f\"\"\"\r\n            QDialog {{\r\n                background-color: {COLORS['tile_background']};\r\n                border: 2px solid {COLORS['border_light']};\r\n                border-radius: 12px;\r\n            }}\r\n        \"\"\")\r\n\r\n        layout = QVBoxLayout(self)\r\n        layout.setContentsMargins(24, 24, 24, 24)\r\n        layout.setSpacing(16)\r\n\r\n        # Icon and title\r\n        if icon_type == \"error\":\r\n            icon_text = \"‚ùå\"\r\n            title_color = COLORS['red_status']\r\n        elif icon_type == \"warning\":\r\n            icon_text = \"‚ö†Ô∏è\"\r\n            title_color = COLORS['uat_text']\r\n        elif icon_type == \"info\":\r\n            icon_text = \"‚ÑπÔ∏è\"\r\n            title_color = COLORS['primary']\r\n        else:\r\n            icon_text = \"‚úÖ\"\r\n            title_color = COLORS['green_status']\r\n\r\n        icon_label = QLabel(icon_text)\r\n        icon_label.setStyleSheet(\"font-size: 32px; border: none;\")\r\n        icon_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\r\n        layout.addWidget(icon_label)\r\n\r\n        # Title\r\n        if title:\r\n            title_label = QLabel(title)\r\n            title_label.setStyleSheet(f\"\"\"\r\n                font-size: 18px;\r\n                font-weight: bold;\r\n                color: {title_color};\r\n                font-family: Inter, sans-serif;\r\n                border: none;\r\n                margin: 0px;\r\n                padding: 0px;\r\n            \"\"\")\r\n            title_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\r\n            title_label.setWordWrap(True)\r\n            layout.addWidget(title_label)\r\n\r\n        # Message with FIXED contrast - dark text on light background\r\n        message_label = QLabel(message)\r\n        message_label.setStyleSheet(f\"\"\"\r\n            font-size: 14px;\r\n            color: {COLORS['text_light']};\r\n            font-family: Inter, sans-serif;\r\n            border: none;\r\n            margin: 0px;\r\n            padding: 8px;\r\n            background-color: transparent;\r\n            line-height: 1.4;\r\n        \"\"\")\r\n        message_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\r\n        message_label.setWordWrap(True)\r\n        # FIXED: Allow the label to expand to show full content\r\n        message_label.setMinimumHeight(50)\r\n        message_label.adjustSize()\r\n        layout.addWidget(message_label)\r\n\r\n        # Add stretch to push button to bottom\r\n        layout.addStretch()\r\n\r\n        # Buttons\r\n        button_layout = QHBoxLayout()\r\n        button_layout.setSpacing(12)\r\n\r\n        ok_button = QPushButton(\"OK\")\r\n        ok_button.clicked.connect(self.accept)\r\n        ok_button.setStyleSheet(f\"\"\"\r\n            QPushButton {{\r\n                background-color: {COLORS['primary']};\r\n                color: white;\r\n                border: none;\r\n                padding: 10px 20px;\r\n                border-radius: 6px;\r\n                font-weight: 600;\r\n                font-size: 13px;\r\n                font-family: Inter, sans-serif;\r\n                min-width: 80px;\r\n            }}\r\n            QPushButton:hover {{\r\n                background-color: rgba(35, 139, 230, 0.8);\r\n            }}\r\n        \"\"\")\r\n\r\n        button_layout.addStretch()\r\n        button_layout.addWidget(ok_button)\r\n        button_layout.addStretch()\r\n        layout.addLayout(button_layout)\r\n\r\n    def center_on_parent_delayed(self):\r\n        \"\"\"FIXED: Delayed centering with proper geometry validation\"\"\"\r\n        if self.parent():\r\n            # Ensure the parent widget is visible and has proper geometry\r\n            parent = self.parent()\r\n\r\n            # Wait for parent to be properly shown and positioned\r\n            if hasattr(parent, 'isVisible') and parent.isVisible():\r\n                parent_rect = parent.geometry()\r\n\r\n                # FIXED: Validate that parent has proper geometry (not 0,0,x,y)\r\n                if parent_rect.x() == 0 and parent_rect.y() == 0:\r\n                    # If parent geometry is still not set, try to get the window geometry\r\n                    if hasattr(parent, 'window'):\r\n                        window = parent.window()\r\n                        if window and window != parent:\r\n                            parent_rect = window.geometry()\r\n\r\n                    # If still at 0,0, center on screen instead\r\n                    if parent_rect.x() == 0 and parent_rect.y() == 0:\r\n                        self.center_on_screen()\r\n                        return\r\n\r\n                # Calculate center position\r\n                x = parent_rect.x() + (parent_rect.width() - self.width()) // 2\r\n                y = parent_rect.y() + (parent_rect.height() - self.height()) // 2\r\n\r\n                # Ensure the dialog stays within screen bounds\r\n                screen = self.screen().geometry() if self.screen() else None\r\n                if screen:\r\n                    x = max(0, min(x, screen.width() - self.width()))\r\n                    y = max(0, min(y, screen.height() - self.height()))\r\n\r\n                self.move(x, y)\r\n            else:\r\n                # Parent not visible yet, try again after a short delay\r\n                QTimer.singleShot(50, self.center_on_parent_delayed)\r\n        else:\r\n            self.center_on_screen()\r\n\r\n    def center_on_screen(self):\r\n        \"\"\"Center the dialog on screen\"\"\"\r\n        screen = self.screen().geometry() if self.screen() else None\r\n        if screen:\r\n            x = (screen.width() - self.width()) // 2\r\n            y = (screen.height() - self.height()) // 2\r\n            self.move(x, y)\r\n\r\n\r\nclass ApplicationTile(QFrame):\r\n    \"\"\"Modern application tile with STRONG contrast and NO BORDERS\"\"\"\r\n\r\n    def __init__(self, app_name, app_description, shared_drive_path, environment,\r\n                 release_date, validity_period, version_number, registration_id, parent=None):\r\n        super().__init__(parent)\r\n\r\n        # Store all the data\r\n        self.app_name = app_name\r\n        self.app_description = app_description\r\n        self.shared_drive_path = shared_drive_path\r\n        self.environment = environment\r\n        self.release_date = release_date\r\n        self.validity_period = validity_period\r\n        self.version_number = version_number\r\n        self.registration_id = registration_id\r\n\r\n        # Set up paths\r\n        self.install_path = os.environ.get('USERPROFILE')\r\n        self.install_path = os.path.join(f\"{self.install_path}\\\\{APP_DIR}\", app_name)\r\n\r\n        # Initialize version tracking\r\n        self.installed_version = self.get_installed_version()\r\n        self.installed = self.is_app_installed(f\"{self.install_path}\" + \"\\\\\" + f\"{self.app_name}.exe\")\r\n\r\n        # Check status\r\n        self.is_expired = self.check_validity()\r\n        self.update_available = self.check_update_available()\r\n\r\n        # Initialize flip state\r\n        self.is_flipped = False\r\n\r\n        # Create both sides\r\n        self.front_widget = QWidget()\r\n        self.back_widget = QWidget()\r\n        self.stacked_layout = QStackedLayout(self)\r\n\r\n        self.setup_front_ui()\r\n        self.setup_back_ui()\r\n\r\n        self.stacked_layout.addWidget(self.front_widget)\r\n        self.stacked_layout.addWidget(self.back_widget)\r\n\r\n        # Set context menu\r\n        self.setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)\r\n        self.customContextMenuRequested.connect(self.show_context_menu)\r\n\r\n        # FIXED: Better sizing and styling\r\n        self.setFixedHeight(200)\r\n        self.setFixedWidth(300)\r\n        self.setup_styles()\r\n\r\n        # Add overlay if expired\r\n        if self.is_expired:\r\n            self.add_expired_overlay()\r\n\r\n    def setup_styles(self):\r\n        \"\"\"FIXED: Apply better styling with proper contrast\"\"\"\r\n        self.setStyleSheet(f\"\"\"\r\n            ApplicationTile {{\r\n                background-color: {COLORS['tile_background']};\r\n                border-radius: 12px;\r\n                border: 1px solid {COLORS['border_dark']};\r\n                margin: 2px;\r\n            }}\r\n            ApplicationTile:hover {{\r\n                background-color: {COLORS['tile_hover']};\r\n                border: 1px solid {COLORS['primary']};\r\n            }}\r\n        \"\"\")\r\n\r\n    def setup_front_ui(self):\r\n        \"\"\"FIXED: Setup front side with proper spacing and no overlapping\"\"\"\r\n        layout = QVBoxLayout(self.front_widget)\r\n        layout.setContentsMargins(16, 16, 16, 16)\r\n        layout.setSpacing(12)\r\n\r\n        # FIXED: Apply consistent background styling\r\n        self.front_widget.setStyleSheet(f\"\"\"\r\n            QWidget {{\r\n                background-color: transparent;\r\n                border: none;\r\n            }}\r\n        \"\"\")\r\n\r\n        # FIXED: Header with proper spacing\r\n        header_layout = QHBoxLayout()\r\n        header_layout.setSpacing(8)\r\n        header_layout.setContentsMargins(0, 0, 0, 0)\r\n\r\n        self.env_label = EnvironmentLabel(self.environment)\r\n        header_layout.addWidget(self.env_label)\r\n        header_layout.addStretch()\r\n\r\n        # FIXED: Status indicator with better styling\r\n        self.status_indicator = QLabel(\"Not Installed\")\r\n        self.status_indicator.setStyleSheet(f\"\"\"\r\n            color: {COLORS['text_dark']};\r\n            font-size: 10px;\r\n            font-weight: 600;\r\n            font-family: Inter, sans-serif;\r\n            border: none;\r\n            padding: 0px;\r\n        \"\"\")\r\n        header_layout.addWidget(self.status_indicator)\r\n        layout.addLayout(header_layout)\r\n\r\n        # FIXED: App name with better sizing\r\n        self.name_label = QLabel(self.app_name)\r\n        self.name_label.setStyleSheet(f\"\"\"\r\n            font-weight: 700;\r\n            font-size: 16px;\r\n            color: {COLORS['text_light']};\r\n            font-family: Inter, sans-serif;\r\n            margin: 0px;\r\n            padding: 0px;\r\n            border: none;\r\n        \"\"\")\r\n        self.name_label.setWordWrap(True)\r\n        self.name_label.setMaximumHeight(40)  # FIXED: Limit height to prevent overflow\r\n        layout.addWidget(self.name_label)\r\n\r\n        # FIXED: Description with controlled height\r\n        self.description_label = QLabel(self.app_description.strip())\r\n        self.description_label.setWordWrap(True)\r\n        self.description_label.setFixedHeight(35)  # FIXED: Smaller fixed height\r\n        self.description_label.setAlignment(Qt.AlignmentFlag.AlignLeft | Qt.AlignmentFlag.AlignTop)\r\n        self.description_label.setStyleSheet(f\"\"\"\r\n            color: {COLORS['text_medium']};\r\n            font-size: 11px;\r\n            font-family: Inter, sans-serif;\r\n            line-height: 1.3;\r\n            border: none;\r\n            padding: 0px;\r\n            margin: 0px;\r\n        \"\"\")\r\n        layout.addWidget(self.description_label)\r\n\r\n        # FIXED: Add stretch to push buttons to bottom\r\n        layout.addStretch()\r\n\r\n        # FIXED: Progress bar - NO PERCENTAGE, just blue line\r\n        self.progress_bar = QProgressBar()\r\n        self.progress_bar.setVisible(False)\r\n        self.progress_bar.setTextVisible(False)  # FIXED: Hide percentage text\r\n        self.progress_bar.setStyleSheet(f\"\"\"\r\n            QProgressBar {{\r\n                border: none;\r\n                border-radius: 4px;\r\n                background-color: {COLORS['progress_bg']};\r\n                height: 8px;\r\n                margin: 4px 0px;\r\n            }}\r\n            QProgressBar::chunk {{\r\n                background-color: {COLORS['progress_fill']};\r\n                border-radius: 4px;\r\n            }}\r\n        \"\"\")\r\n        layout.addWidget(self.progress_bar)\r\n\r\n        # FIXED: Buttons with better layout and spacing\r\n        button_layout = QHBoxLayout()\r\n        button_layout.setSpacing(8)\r\n        button_layout.setContentsMargins(0, 0, 0, 0)\r\n\r\n        self.install_launch_button = QPushButton(\"Install\")\r\n        self.install_launch_button.clicked.connect(self.on_install_launch_clicked)\r\n        self.install_launch_button.setStyleSheet(f\"\"\"\r\n            QPushButton {{\r\n                background-color: {COLORS['primary']};\r\n                color: white;\r\n                border: none;\r\n                padding: 8px 12px;\r\n                border-radius: 6px;\r\n                font-weight: 600;\r\n                font-size: 11px;\r\n                font-family: Inter, sans-serif;\r\n                min-width: 60px;\r\n                max-height: 28px;\r\n            }}\r\n            QPushButton:hover {{\r\n                background-color: rgba(35, 139, 230, 0.9);\r\n            }}\r\n            QPushButton:pressed {{\r\n                background-color: rgba(35, 139, 230, 0.7);\r\n            }}\r\n            QPushButton:disabled {{\r\n                background-color: {COLORS['border_dark']};\r\n                color: {COLORS['text_dark']};\r\n            }}\r\n        \"\"\")\r\n\r\n        self.uninstall_button = QPushButton(\"Uninstall\")\r\n        self.uninstall_button.setEnabled(True)\r\n        self.uninstall_button.clicked.connect(self.on_uninstall_clicked)\r\n        self.uninstall_button.setStyleSheet(f\"\"\"\r\n            QPushButton {{\r\n                background-color: {COLORS['border_light']};\r\n                color: {COLORS['text_light']};\r\n                border: none;\r\n                padding: 8px 12px;\r\n                border-radius: 6px;\r\n                font-weight: 600;\r\n                font-size: 11px;\r\n                font-family: Inter, sans-serif;\r\n                min-width: 60px;\r\n                max-height: 28px;\r\n            }}\r\n            QPushButton:hover {{\r\n                background-color: rgba(72, 79, 88, 0.9);\r\n            }}\r\n            QPushButton:pressed {{\r\n                background-color: rgba(72, 79, 88, 0.7);\r\n            }}\r\n            QPushButton:disabled {{\r\n                background-color: {COLORS['border_dark']};\r\n                color: {COLORS['text_dark']};\r\n            }}\r\n        \"\"\")\r\n\r\n        button_layout.addWidget(self.install_launch_button)\r\n        button_layout.addWidget(self.uninstall_button)\r\n        layout.addLayout(button_layout)\r\n\r\n        # Update initial button states\r\n        if self.is_app_installed(f'{self.install_path}.exe'):\r\n            self.installed = True\r\n            self.uninstall_button.setEnabled(True)\r\n        self.update_button_states()\r\n\r\n    def setup_back_ui(self):\r\n        \"\"\"FIXED: Setup back side with proper spacing and no text overlap\"\"\"\r\n        main_layout = QVBoxLayout(self.back_widget)\r\n        main_layout.setContentsMargins(16, 16, 16, 16)\r\n        main_layout.setSpacing(12)\r\n\r\n        # FIXED: Apply consistent background styling\r\n        self.back_widget.setStyleSheet(f\"\"\"\r\n            QWidget {{\r\n                background-color: transparent;\r\n                border: none;\r\n            }}\r\n        \"\"\")\r\n\r\n        # FIXED: Title with proper spacing\r\n        title_label = QLabel(\"Application Details\")\r\n        title_label.setStyleSheet(f\"\"\"\r\n            font-size: 14px;\r\n            font-weight: bold;\r\n            color: {COLORS['text_light']};\r\n            font-family: Inter, sans-serif;\r\n            margin-bottom: 8px;\r\n            border: none;\r\n            padding: 0px;\r\n        \"\"\")\r\n        main_layout.addWidget(title_label)\r\n\r\n        # FIXED: Details with controlled spacing and no overlap\r\n        details = [\r\n            (\"IAHub ID\", \"Not Registered\" if pd.isna(self.registration_id) else str(self.registration_id)),\r\n            (\"Release Date\", str(pd.Timestamp(self.release_date))[:10] if self.release_date else \"N/A\"),\r\n            (\"Version\", str(self.version_number) if self.version_number else \"1.0\"),\r\n            (\"Status\", \"Expired\" if self.is_expired else \"Active\")\r\n        ]\r\n\r\n        for title, value in details:\r\n            # FIXED: Each detail in its own container with controlled height\r\n            detail_container = QWidget()\r\n            detail_container.setStyleSheet(\"border: none;\")\r\n            detail_container.setFixedHeight(35)  # FIXED: Control height to prevent overlap\r\n            detail_layout = QVBoxLayout(detail_container)\r\n            detail_layout.setSpacing(2)\r\n            detail_layout.setContentsMargins(0, 2, 0, 2)\r\n\r\n            title_label = QLabel(title)\r\n            title_label.setStyleSheet(f\"\"\"\r\n                color: {COLORS['text_dark']};\r\n                font-size: 9px;\r\n                font-weight: 500;\r\n                font-family: Inter, sans-serif;\r\n                border: none;\r\n                padding: 0px;\r\n                margin: 0px;\r\n            \"\"\")\r\n            detail_layout.addWidget(title_label)\r\n\r\n            value_label = QLabel(str(value))\r\n            value_label.setStyleSheet(f\"\"\"\r\n                color: {COLORS['text_medium']};\r\n                font-size: 11px;\r\n                font-weight: 600;\r\n                font-family: Inter, sans-serif;\r\n                border: none;\r\n                padding: 0px;\r\n                margin: 0px;\r\n            \"\"\")\r\n            value_label.setWordWrap(True)\r\n            value_label.setMaximumHeight(20)  # FIXED: Limit height\r\n            detail_layout.addWidget(value_label)\r\n\r\n            main_layout.addWidget(detail_container)\r\n\r\n        main_layout.addStretch()\r\n\r\n    def show_context_menu(self, position):\r\n        \"\"\"Show context menu for flipping\"\"\"\r\n        context_menu = QMenu(self)\r\n        context_menu.setStyleSheet(f\"\"\"\r\n            QMenu {{\r\n                background-color: {COLORS['tile_background']};\r\n                border: 1px solid {COLORS['border_light']};\r\n                border-radius: 6px;\r\n                padding: 4px;\r\n            }}\r\n            QMenu::item {{\r\n                padding: 6px 12px;\r\n                border-radius: 4px;\r\n                color: {COLORS['text_light']};\r\n                border: none;\r\n            }}\r\n            QMenu::item:selected {{\r\n                background-color: {COLORS['primary']};\r\n            }}\r\n        \"\"\")\r\n\r\n        flip_action = context_menu.addAction(\"Show Details\" if not self.is_flipped else \"Show Main\")\r\n        action = context_menu.exec(self.mapToGlobal(position))\r\n        if action == flip_action:\r\n            self.flip_tile()\r\n\r\n    def flip_tile(self):\r\n        \"\"\"Flip the tile\"\"\"\r\n        self.is_flipped = not self.is_flipped\r\n        self.stacked_layout.setCurrentIndex(1 if self.is_flipped else 0)\r\n\r\n    def add_expired_overlay(self):\r\n        \"\"\"Add expired overlay\"\"\"\r\n        self.overlay = QWidget(self)\r\n        self.overlay.setStyleSheet(\"\"\"\r\n            background-color: rgba(0, 0, 0, 0.6);\r\n            border-radius: 12px;\r\n            border: none;\r\n        \"\"\")\r\n        self.overlay.setGeometry(self.rect())\r\n        self.overlay.show()\r\n        self.front_widget.setEnabled(False)\r\n\r\n    # Keep all the original methods for functionality\r\n    def on_install_launch_clicked(self):\r\n        if self.update_available:\r\n            self.update_application()\r\n        elif not self.installed:\r\n            self.install_application()\r\n        else:\r\n            self.launch_application()\r\n\r\n    def is_app_installed(self, local_path):\r\n        return os.path.exists(local_path)\r\n\r\n    def install_application(self):\r\n        # FIXED: Better UI feedback during installation\r\n        self.progress_bar.setVisible(True)\r\n        self.status_indicator.setText(\"Installing...\")\r\n        self.install_launch_button.setEnabled(False)  # FIXED: Disable button during install\r\n\r\n        os.makedirs(self.install_path, exist_ok=True)\r\n        destination_file = os.path.join(self.install_path, f\"{self.app_name}.exe\")\r\n\r\n        self.install_thread = InstallThread(self.shared_drive_path, destination_file)\r\n        self.install_thread.progress.connect(self.update_progress)\r\n        self.install_thread.finished.connect(self.installation_finished)\r\n        self.install_thread.error.connect(self.installation_error)\r\n        self.install_thread.start()\r\n\r\n    def installation_error(self, error_message):\r\n        self.progress_bar.setVisible(False)\r\n        self.status_indicator.setText(\"Installation Failed\")\r\n        self.install_launch_button.setEnabled(True)  # FIXED: Re-enable button\r\n\r\n        # FIXED: Use custom message box with proper contrast\r\n        dialog = CustomMessageBox(\r\n            parent=self.window(),\r\n            title=\"Installation Error\",\r\n            message=f\"Failed to install {self.app_name}:\\n{error_message}\",\r\n            icon_type=\"error\"\r\n        )\r\n        dialog.exec()\r\n\r\n    def update_progress(self, value):\r\n        self.progress_bar.setValue(value)\r\n\r\n    def installation_finished(self):\r\n        self.installed = True\r\n        self.save_installed_version()\r\n        self.installed_version = self.version_number\r\n        self.update_available = False\r\n        self.update_button_states()\r\n        self.progress_bar.setVisible(False)\r\n        self.install_launch_button.setEnabled(True)  # FIXED: Re-enable button\r\n\r\n        # FIXED: Use custom message box\r\n        dialog = CustomMessageBox(\r\n            parent=self.window(),\r\n            title=\"Installation Complete\",\r\n            message=f\"{self.app_name} has been successfully installed.\",\r\n            icon_type=\"success\"\r\n        )\r\n        dialog.exec()\r\n\r\n    def launch_application(self):\r\n        # pslv_action_entry([{'SID': user_main, 'action': f'Launched {self.app_name}'}])\r\n        executable_path = os.path.join(self.install_path, f\"{self.app_name}.exe\")\r\n        release_date = pd.Timestamp(self.release_date)\r\n        expiry_date = release_date + timedelta(days=self.validity_period)\r\n        days_remaining = expiry_date - datetime.now()\r\n        if os.path.exists(executable_path):\r\n            try:\r\n                if pd.isna(self.registration_id) and self.environment == 'BETA':\r\n                    # FIXED: Use custom message box\r\n                    dialog = CustomMessageBox(\r\n                        parent=self.window(),\r\n                        title=\"Action Required\",\r\n                        message=f'Application is not registered at IA Hub and will stop working in {days_remaining.days} days.',\r\n                        icon_type=\"warning\"\r\n                    )\r\n                    dialog.exec()\r\n                LauncherSecurity.generate_launch_token(executable_path)\r\n                os.startfile(executable_path)\r\n            except Exception as e:\r\n                # FIXED: Use custom message box\r\n                dialog = CustomMessageBox(\r\n                    parent=self.window(),\r\n                    title=\"Error\",\r\n                    message=f'Failed to launch application: {str(e)}',\r\n                    icon_type=\"error\"\r\n                )\r\n                dialog.exec()\r\n        else:\r\n            # FIXED: Use custom message box\r\n            dialog = CustomMessageBox(\r\n                parent=self.window(),\r\n                title=\"Error\",\r\n                message=f'Application executable not found at {executable_path}',\r\n                icon_type=\"error\"\r\n            )\r\n            dialog.exec()\r\n\r\n    def on_uninstall_clicked(self):\r\n        if self.installed:\r\n            try:\r\n                shutil.rmtree(self.install_path)\r\n                self.installed = False\r\n                self.status_indicator.setText(\"Not Installed\")\r\n                self.install_launch_button.setText(\"Install\")\r\n                # pslv_action_entry([{'SID': user_main, 'action': f'Uninstalled {self.app_name}'}])\r\n\r\n                # FIXED: Use custom message box\r\n                dialog = CustomMessageBox(\r\n                    parent=self.window(),\r\n                    title=\"Uninstall Complete\",\r\n                    message=f'{self.app_name} has been successfully uninstalled.',\r\n                    icon_type=\"success\"\r\n                )\r\n                dialog.exec()\r\n            except Exception as e:\r\n                # FIXED: Use custom message box\r\n                dialog = CustomMessageBox(\r\n                    parent=self.window(),\r\n                    title=\"Uninstall Error\",\r\n                    message=f'Failed to uninstall {self.app_name}: {str(e)}',\r\n                    icon_type=\"error\"\r\n                )\r\n                dialog.exec()\r\n\r\n    def check_validity(self):\r\n        try:\r\n            # release_date = pd.Timestamp(self.release_date)\r\n            # expiry_date = release_date + timedelta(days=self.validity_period)\r\n            # return datetime.now() > expiry_date\r\n            return False\r\n        except Exception as e:\r\n            print(f\"Error checking validity: {str(e)}\")\r\n            return False\r\n\r\n    def check_update_available(self):\r\n        try:\r\n            installed_version = self.get_installed_version()\r\n            if self.version_number and self.installed:\r\n                if installed_version is None:\r\n                    return True\r\n                return float(self.version_number) > float(installed_version)\r\n            return False\r\n        except Exception as e:\r\n            print(f\"Error checking for updates: {str(e)}\")\r\n            return False\r\n\r\n    def update_button_states(self):\r\n        if self.is_expired:\r\n            self.status_indicator.setText(\"Expired\")\r\n            self.status_indicator.setStyleSheet(\r\n                f\"color: {COLORS['red_status']}; font-size: 10px; font-weight: 600; border: none; padding: 0px;\")\r\n            self.install_launch_button.setEnabled(False)\r\n            self.uninstall_button.setEnabled(False)\r\n            return\r\n        if self.update_available:\r\n            self.install_launch_button.setText(\"Update\")\r\n            self.status_indicator.setText(\"Update Available\")\r\n            self.status_indicator.setStyleSheet(\r\n                f\"color: {COLORS['uat_text']}; font-size: 10px; font-weight: 600; border: none; padding: 0px;\")\r\n        elif self.installed:\r\n            self.install_launch_button.setText(\"Launch\")\r\n            self.status_indicator.setText(\"Installed\")\r\n            self.status_indicator.setStyleSheet(\r\n                f\"color: {COLORS['green_status']}; font-size: 10px; font-weight: 600; border: none; padding: 0px;\")\r\n        else:\r\n            self.install_launch_button.setText(\"Install\")\r\n            self.status_indicator.setText(\"Not Installed\")\r\n            self.status_indicator.setStyleSheet(\r\n                f\"color: {COLORS['text_dark']}; font-size: 10px; font-weight: 600; border: none; padding: 0px;\")\r\n\r\n    def get_installed_version(self):\r\n        version_file = os.path.join(self.install_path, \"version.txt\")\r\n        if os.path.exists(version_file):\r\n            try:\r\n                with open(version_file, 'r') as f:\r\n                    return float(f.read().strip())\r\n            except:\r\n                return None\r\n        return None\r\n\r\n    def save_installed_version(self):\r\n        try:\r\n            os.makedirs(self.install_path, exist_ok=True)\r\n            version_file = os.path.join(self.install_path, \"version.txt\")\r\n            with open(version_file, 'w') as f:\r\n                f.write(str(self.version_number))\r\n        except Exception as e:\r\n            print(f\"Error saving version info: {str(e)}\")\r\n\r\n    def update_application(self):\r\n        latest_version = self.version_number\r\n        if latest_version:\r\n            try:\r\n                if os.path.exists(self.install_path):\r\n                    shutil.rmtree(self.install_path)\r\n\r\n                self.install_application()\r\n                self.version_number = latest_version\r\n                self.update_available = False\r\n                self.update_button_states()\r\n            except Exception as e:\r\n                # FIXED: Use custom message box\r\n                dialog = CustomMessageBox(\r\n                    parent=self.window(),\r\n                    title=\"Update Error\",\r\n                    message=f\"Failed to update {self.app_name}: {str(e)}\",\r\n                    icon_type=\"error\"\r\n                )\r\n                dialog.exec()\r\n\r\n\r\nclass NoAccessWidget(QWidget):\r\n    \"\"\"FIXED: Compact no access widget that matches the design exactly\"\"\"\r\n\r\n    def __init__(self, is_gfbm_user):\r\n        super().__init__()\r\n        self.is_gfbm_user = is_gfbm_user\r\n        self.setupUI()\r\n\r\n    def setupUI(self):\r\n        # FIXED: Set a maximum size for the widget to prevent over-expansion\r\n        self.setMaximumSize(500, 350)\r\n        self.setMinimumSize(500, 350)\r\n\r\n        # Main layout with no margins to keep it compact\r\n        main_layout = QVBoxLayout(self)\r\n        main_layout.setContentsMargins(0, 0, 0, 0)\r\n        main_layout.setSpacing(0)\r\n\r\n        # FIXED: Create the message container with exact sizing\r\n        container = QFrame()\r\n        container.setFixedSize(500, 350)  # Exact size matching the design\r\n        container.setStyleSheet(f\"\"\"\r\n            QFrame {{\r\n                background-color: {COLORS['tile_background']};\r\n                border-radius: 12px;\r\n                border: 1px solid {COLORS['border_dark']};\r\n            }}\r\n        \"\"\")\r\n\r\n        # Container layout with proper spacing\r\n        container_layout = QVBoxLayout(container)\r\n        container_layout.setContentsMargins(32, 32, 32, 32)\r\n        container_layout.setSpacing(16)\r\n        container_layout.setAlignment(Qt.AlignmentFlag.AlignCenter)\r\n\r\n        # FIXED: Icon - using the red prohibition sign like in the image\r\n        icon_label = QLabel(\"üö´\")\r\n        icon_label.setStyleSheet(f\"\"\"\r\n            font-size: 48px;\r\n            color: {COLORS['red_status']};\r\n            border: none;\r\n        \"\"\")\r\n        icon_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\r\n        container_layout.addWidget(icon_label)\r\n\r\n        # FIXED: Title with proper styling\r\n        title_label = QLabel(\"No Application Access\")\r\n        title_label.setStyleSheet(f\"\"\"\r\n            font-size: 20px;\r\n            font-weight: bold;\r\n            color: {COLORS['text_light']};\r\n            font-family: Inter, sans-serif;\r\n            border: none;\r\n            margin: 0px;\r\n            padding: 0px;\r\n        \"\"\")\r\n        title_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\r\n        container_layout.addWidget(title_label)\r\n\r\n        # FIXED: Description with proper line breaks and styling\r\n        description_text = (\"Currently, you do not have access to any application.\\n\"\r\n                          \"Please contact administrator for access permissions.\")\r\n        if not self.is_gfbm_user:\r\n            description_text = (\"Thanks for showing your interest for PSLV.\\n\"\r\n                              \"At present, Application is accessible for Global Finance & Business Management India.\")\r\n\r\n        description_label = QLabel(description_text)\r\n        description_label.setStyleSheet(f\"\"\"\r\n            font-size: 13px;\r\n            color: {COLORS['text_medium']};\r\n            font-family: Inter, sans-serif;\r\n            border: none;\r\n            line-height: 2;\r\n            margin: 0px;\r\n            padding: 0px;\r\n        \"\"\")\r\n        description_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\r\n        description_label.setWordWrap(True)\r\n        container_layout.addWidget(description_label)\r\n\r\n        # Add some spacing\r\n        container_layout.addSpacing(8)\r\n\r\n        # FIXED: Help Center button with proper styling\r\n        help_button = QPushButton(\"Help Center\")\r\n        help_button.setStyleSheet(f\"\"\"\r\n            QPushButton {{\r\n                background-color: {COLORS['primary']};\r\n                color: white;\r\n                border: none;\r\n                padding: 10px 24px;\r\n                border-radius: 6px;\r\n                font-weight: 600;\r\n                font-size: 13px;\r\n                font-family: Inter, sans-serif;\r\n                min-width: 120px;\r\n                max-width: 160px;\r\n            }}\r\n            QPushButton:hover {{\r\n                background-color: rgba(35, 139, 230, 0.9);\r\n            }}\r\n            QPushButton:pressed {{\r\n                background-color: rgba(35, 139, 230, 0.7);\r\n            }}\r\n        \"\"\")\r\n        help_button.clicked.connect(self.contact_admin)\r\n        container_layout.addWidget(help_button, alignment=Qt.AlignmentFlag.AlignCenter)\r\n\r\n        # Add the container to main layout\r\n        main_layout.addWidget(container)\r\n\r\n    def contact_admin(self):\r\n        \"\"\"Open help center URL\"\"\"\r\n        support_url = QUrl(\r\n            \"https://confluence.prod.aws.jpmchase.net/confluence/spaces/GFITECH/pages/5228999093/APPLICATION+OWNER+AND+ADMINS\")\r\n        QDesktopServices.openUrl(support_url)\r\n\r\n\r\nclass MainWindow(QMainWindow):\r\n    \"\"\"Main window with FIXED ApplicationTile integration and custom dialogs\"\"\"\r\n\r\n    def __init__(self, df, cost_center, userdata):\r\n        super().__init__()\r\n        self.all_tiles = []\r\n        self.access = df\r\n        self.cost_center_df = cost_center\r\n        self.userdata = userdata\r\n        self.user_details = self.get_user_details()\r\n        self.is_gfbm_user = self.is_gfbm_user_check()\r\n        self.username = user_main\r\n        self.current_filter = \"All\"\r\n\r\n        self.setWindowTitle(\"PSLV by STD, GF&BM India\")\r\n        icon_path = resource_path(f\"resources/STDJustLogo.PNG\")\r\n        self.setWindowIcon(QIcon(icon_path))\r\n        self.setFixedSize(1400, 800)\r\n\r\n        # Apply dark theme\r\n        self.setStyleSheet(f\"\"\"\r\n            QMainWindow {{\r\n                background-color: {COLORS['background_dark']};\r\n                font-family: Inter, sans-serif;\r\n                border: none;\r\n            }}\r\n        \"\"\")\r\n\r\n        central_widget = QWidget()\r\n        self.setCentralWidget(central_widget)\r\n        main_layout = QHBoxLayout(central_widget)\r\n        main_layout.setSpacing(0)\r\n        main_layout.setContentsMargins(0, 0, 0, 0)\r\n\r\n        # Sidebar\r\n        sidebar = self.create_sidebar()\r\n        main_layout.addWidget(sidebar)\r\n\r\n        # Main content area\r\n        content_area = QWidget()\r\n        content_layout = QVBoxLayout(content_area)\r\n        content_layout.setContentsMargins(32, 32, 32, 32)\r\n        content_layout.setSpacing(24)\r\n\r\n        # Header with title and filters\r\n        header_layout = QHBoxLayout()\r\n\r\n        title_label = QLabel(\"Available Applications\")\r\n        title_label.setStyleSheet(f\"\"\"\r\n            font-size: 28px;\r\n            font-weight: bold;\r\n            color: {COLORS['text_light']};\r\n            font-family: Inter, sans-serif;\r\n            border: none;\r\n        \"\"\")\r\n        header_layout.addWidget(title_label)\r\n        header_layout.addStretch()\r\n\r\n        # Filter buttons\r\n        filter_container = QWidget()\r\n        filter_layout = QHBoxLayout(filter_container)\r\n        filter_layout.setSpacing(8)\r\n        filter_layout.setContentsMargins(0, 0, 0, 0)\r\n\r\n        self.filter_group = QButtonGroup()\r\n        filter_buttons = [\"All\", \"UAT\", \"BETA\", \"PROD\"]\r\n\r\n        for idx, filter_name in enumerate(filter_buttons):\r\n            btn = QPushButton(filter_name)\r\n            btn.setCheckable(True)\r\n            btn.setChecked(filter_name == \"All\")\r\n            btn.clicked.connect(lambda checked, f=filter_name: self.apply_filter(f))\r\n            self.filter_group.addButton(btn, idx)\r\n\r\n            if filter_name == \"All\":\r\n                btn.setStyleSheet(f\"\"\"\r\n                    QPushButton {{\r\n                        background-color: {COLORS['primary']};\r\n                        color: white;\r\n                        border: none;\r\n                        padding: 8px 16px;\r\n                        border-radius: 8px;\r\n                        font-weight: 600;\r\n                        font-size: 13px;\r\n                        font-family: Inter, sans-serif;\r\n                    }}\r\n                    QPushButton:checked {{\r\n                        background-color: {COLORS['primary']};\r\n                    }}\r\n                    QPushButton:hover {{\r\n                        background-color: rgba(35, 139, 230, 0.8);\r\n                    }}\r\n                \"\"\")\r\n            else:\r\n                btn.setStyleSheet(f\"\"\"\r\n                    QPushButton {{\r\n                        background-color: transparent;\r\n                        color: {COLORS['text_dark']};\r\n                        border: none;\r\n                        padding: 8px 16px;\r\n                        border-radius: 8px;\r\n                        font-weight: 600;\r\n                        font-size: 13px;\r\n                        font-family: Inter, sans-serif;\r\n                    }}\r\n                    QPushButton:checked {{\r\n                        background-color: {COLORS['primary']};\r\n                        color: white;\r\n                    }}\r\n                    QPushButton:hover {{\r\n                        background-color: {COLORS['surface_dark']};\r\n                        color: {COLORS['text_light']};\r\n                    }}\r\n                \"\"\")\r\n\r\n            filter_layout.addWidget(btn)\r\n\r\n        header_layout.addWidget(filter_container)\r\n\r\n        # Search bar\r\n        self.search_bar = QLineEdit()\r\n        self.search_bar.setPlaceholderText(\"üîç Search applications...\")\r\n        self.search_bar.textChanged.connect(self.filter_applications)\r\n        self.search_bar.setStyleSheet(f\"\"\"\r\n            QLineEdit {{\r\n                background-color: {COLORS['surface_dark']};\r\n                border: 2px solid {COLORS['border_dark']};\r\n                border-radius: 8px;\r\n                padding: 12px 16px 12px 40px;\r\n                color: {COLORS['text_light']};\r\n                font-size: 14px;\r\n                min-width: 280px;\r\n                font-family: Inter, sans-serif;\r\n            }}\r\n            QLineEdit:focus {{\r\n                border: 2px solid {COLORS['primary']};\r\n            }}\r\n            QLineEdit::placeholder {{\r\n                color: {COLORS['text_dark']};\r\n            }}\r\n        \"\"\")\r\n        header_layout.addWidget(self.search_bar)\r\n        # Refresh button\r\n        self.refresh_button = QPushButton(\"‚ü≤\")\r\n        self.refresh_button.setCursor(Qt.CursorShape.PointingHandCursor)\r\n        self.refresh_button.setToolTip(\"‚ü≤ Refresh Applications\")\r\n        self.refresh_button.clicked.connect(self.refresh_applications)\r\n        self.refresh_button.setStyleSheet(\"\"\"\r\n                           QPushButton {\r\n                               background-color: transparent;\r\n                               color: white;\r\n                               font-size: 20px;\r\n                               padding: 5px;\r\n                               min-width: 30px;\r\n                               font-weight: bold;\r\n                           }\r\n                           QPushButton:hover {\r\n                               color: #4a90e2;\r\n                           }\r\n                       \"\"\")\r\n        header_layout.addWidget(self.refresh_button)\r\n\r\n        content_layout.addLayout(header_layout)\r\n\r\n        # Scroll area for applications\r\n        scroll_area = QScrollArea()\r\n        scroll_area.setWidgetResizable(True)\r\n        scroll_area.setHorizontalScrollBarPolicy(Qt.ScrollBarPolicy.ScrollBarAlwaysOff)\r\n        scroll_area.setStyleSheet(f\"\"\"\r\n            QScrollArea {{\r\n                border: none;\r\n                background-color: transparent;\r\n            }}\r\n            QScrollBar:vertical {{\r\n                border: none;\r\n                background: {COLORS['background_dark']};\r\n                width: 8px;\r\n                border-radius: 4px;\r\n            }}\r\n            QScrollBar::handle:vertical {{\r\n                background: {COLORS['border_dark']};\r\n                border-radius: 4px;\r\n            }}\r\n            QScrollBar::handle:vertical:hover {{\r\n                background: {COLORS['text_dark']};\r\n            }}\r\n        \"\"\")\r\n\r\n        scroll_content = QWidget()\r\n        self.app_grid = QGridLayout(scroll_content)\r\n        self.app_grid.setSpacing(16)\r\n        self.app_grid.setAlignment(Qt.AlignmentFlag.AlignTop | Qt.AlignmentFlag.AlignLeft)\r\n        scroll_area.setWidget(scroll_content)\r\n\r\n        self.search_app = QWidget()\r\n        self.search_app_layout = QVBoxLayout(self.search_app)\r\n        self.search_app_layout.addWidget(scroll_area)\r\n\r\n        # Create stacked widget\r\n        self.stacked_widget = QStackedWidget()\r\n        self.stacked_widget.addWidget(self.search_app)\r\n\r\n        # Access control widget (if admin)\r\n        if self.is_administrator():\r\n            self.access_control_widget = AccessControlDialog(self.username, [])\r\n            self.stacked_widget.addWidget(self.access_control_widget)\r\n\r\n        content_layout.addWidget(self.stacked_widget)\r\n        main_layout.addWidget(content_area)\r\n\r\n        # Load applications\r\n        if len(self.access) != 0 and self.is_gfbm_user:\r\n            self.load_applications()\r\n        else:\r\n            # FIXED: Clear the grid and add NoAccessWidget properly centered\r\n            self.clear_layout(self.app_grid)\r\n            # FIXED: Center the NoAccessWidget in the middle of the content area\r\n            self.app_grid.setAlignment(Qt.AlignmentFlag.AlignCenter)\r\n            no_access_widget = NoAccessWidget(self.is_gfbm_user)\r\n            # FIXED: Add the widget to the center of the grid with proper alignment\r\n            self.app_grid.addWidget(no_access_widget, 0, 0, 1, 1, Qt.AlignmentFlag.AlignCenter)\r\n\r\n    def create_sidebar(self):\r\n        \"\"\"Create modern sidebar\"\"\"\r\n        sidebar = QWidget()\r\n        sidebar.setFixedWidth(280)\r\n        sidebar.setStyleSheet(f\"\"\"\r\n            QWidget {{\r\n                background-color: {COLORS['surface_dark']};\r\n                border: none;\r\n            }}\r\n        \"\"\")\r\n\r\n        layout = QVBoxLayout(sidebar)\r\n        layout.setContentsMargins(24, 24, 24, 24)\r\n        layout.setSpacing(16)\r\n\r\n        # Logo/Icon placeholder\r\n        logo_label = QLabel(\"üì¶\")\r\n        logo_label.setStyleSheet(\"font-size: 64px; border: none;\")\r\n        logo_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\r\n        layout.addWidget(logo_label)\r\n\r\n        # User details\r\n        for label_text, icon_name in self.user_details:\r\n            detail_widget = self.create_detail_input(label_text)\r\n            layout.addWidget(detail_widget)\r\n\r\n        layout.addStretch()\r\n\r\n        # Bottom buttons - NO BORDERS\r\n        button_container = QWidget()\r\n        button_layout = QVBoxLayout(button_container)\r\n        button_layout.setSpacing(8)\r\n        button_layout.setContentsMargins(0, 16, 0, 0)\r\n\r\n        # About button\r\n        about_btn = QPushButton(\"‚ÑπÔ∏è  About\")\r\n        about_btn.clicked.connect(self.show_about_dialog)\r\n        about_btn.setStyleSheet(self.get_sidebar_button_style())\r\n        button_layout.addWidget(about_btn)\r\n\r\n        # Help button\r\n        help_btn = QPushButton(\"‚ùì  Help\")\r\n        help_btn.clicked.connect(self.show_help_dialog)\r\n        help_btn.setStyleSheet(self.get_sidebar_button_style())\r\n        button_layout.addWidget(help_btn)\r\n\r\n        # Exit button\r\n        exit_btn = QPushButton(\"üö™  Exit\")\r\n        exit_btn.clicked.connect(self.close_application)  # FIXED: Use proper close method\r\n        exit_btn.setStyleSheet(self.get_sidebar_button_style())\r\n        button_layout.addWidget(exit_btn)\r\n\r\n        layout.addWidget(button_container)\r\n\r\n        return sidebar\r\n\r\n    def close_application(self):\r\n        \"\"\"FIXED: Properly close the application\"\"\"\r\n        self.close()\r\n\r\n    def get_sidebar_button_style(self):\r\n        return f\"\"\"\r\n            QPushButton {{\r\n                background-color: {COLORS['background_dark']};\r\n                color: {COLORS['text_light']};\r\n                border: none;\r\n                padding: 12px 16px;\r\n                border-radius: 8px;\r\n                text-align: left;\r\n                font-weight: 500;\r\n                font-family: Inter, sans-serif;\r\n            }}\r\n            QPushButton:hover {{\r\n                background-color: rgba(19, 138, 236, 0.2);\r\n            }}\r\n        \"\"\"\r\n\r\n    def create_detail_input(self, label_text):\r\n        \"\"\"Create input field for user details\"\"\"\r\n        container = QWidget()\r\n        layout = QVBoxLayout(container)\r\n        layout.setSpacing(4)\r\n        layout.setContentsMargins(0, 0, 0, 0)\r\n\r\n        label = QLabel(label_text.split('\\n')[0] if '\\n' in label_text else label_text[:20])\r\n        label.setStyleSheet(f\"\"\"\r\n            color: {COLORS['text_dark']};\r\n            font-size: 11px;\r\n            font-weight: 500;\r\n            font-family: Inter, sans-serif;\r\n            border: none;\r\n        \"\"\")\r\n        layout.addWidget(label)\r\n\r\n        input_field = QLineEdit()\r\n        input_field.setText(label_text)\r\n        input_field.setReadOnly(True)\r\n        input_field.setStyleSheet(f\"\"\"\r\n            QLineEdit {{\r\n                background-color: {COLORS['background_dark']};\r\n                border: none;\r\n                border-radius: 6px;\r\n                padding: 8px 12px;\r\n                color: {COLORS['text_light']};\r\n                font-size: 13px;\r\n                font-family: Inter, sans-serif;\r\n            }}\r\n        \"\"\")\r\n        layout.addWidget(input_field)\r\n\r\n        return container\r\n\r\n    def show_about_dialog(self):\r\n        \"\"\"FIXED: Show about dialog with no title bar\"\"\"\r\n        dialog = CustomMessageBox(\r\n            parent=self,\r\n            title=\"About Software Center\",\r\n            message=\"Version 3.0\\n2024 @STO, GF&BM India\",\r\n            icon_type=\"info\"\r\n        )\r\n        dialog.exec()\r\n\r\n    def show_help_dialog(self):\r\n        \"\"\"FIXED: Show help dialog with no title bar\"\"\"\r\n        help_text = (\"This is the PSLV Software Center.\\n\\n\"\r\n                     \"‚Ä¢ Browse and install available applications\\n\"\r\n                     \"‚Ä¢ Filter by environment (UAT, BETA, PROD)\\n\"\r\n                     \"‚Ä¢ Search for specific applications\\n\"\r\n                     \"‚Ä¢ Right-click tiles for more options\\n\\n\"\r\n                     \"For assistance, contact Think_STO@restricted.chase.com\")\r\n\r\n        dialog = CustomMessageBox(\r\n            parent=self,\r\n            title=\"Help\",\r\n            message=help_text,\r\n            icon_type=\"info\"\r\n        )\r\n        dialog.exec()\r\n\r\n    def apply_filter(self, filter_name):\r\n        \"\"\"Apply environment filter\"\"\"\r\n        self.current_filter = filter_name\r\n        self.update_grid_layout(self.search_bar.text().lower())\r\n\r\n        # Update button styles\r\n        for button in self.filter_group.buttons():\r\n            if button.text() == filter_name:\r\n                button.setStyleSheet(f\"\"\"\r\n                    QPushButton {{\r\n                        background-color: {COLORS['primary']};\r\n                        color: white;\r\n                        border: none;\r\n                        padding: 8px 16px;\r\n                        border-radius: 8px;\r\n                        font-weight: 600;\r\n                        font-size: 13px;\r\n                        font-family: Inter, sans-serif;\r\n                    }}\r\n                \"\"\")\r\n            else:\r\n                button.setStyleSheet(f\"\"\"\r\n                    QPushButton {{\r\n                        background-color: transparent;\r\n                        color: {COLORS['text_dark']};\r\n                        border: none;\r\n                        padding: 8px 16px;\r\n                        border-radius: 8px;\r\n                        font-weight: 600;\r\n                        font-size: 13px;\r\n                        font-family: Inter, sans-serif;\r\n                    }}\r\n                    QPushButton:hover {{\r\n                        background-color: {COLORS['surface_dark']};\r\n                        color: {COLORS['text_light']};\r\n                    }}\r\n                \"\"\")\r\n\r\n    def load_applications(self):\r\n        \"\"\"Load applications into grid\"\"\"\r\n        try:\r\n            self.clear_layout(self.app_grid)\r\n            self.app_grid.setContentsMargins(0, 0, 0, 0)\r\n            self.app_grid.setAlignment(Qt.AlignmentFlag.AlignTop | Qt.AlignmentFlag.AlignLeft)\r\n            self.all_tiles.clear()\r\n\r\n            self.access['Expired'] = self.access.apply(lambda row: expire_sort(row), axis=1)\r\n            self.access = self.access.sort_values(by=['Expired', 'Solution_Name'], ascending=[True, True])\r\n            self.access.reset_index(inplace=True, drop=True)\r\n\r\n            for i, row in self.access.iterrows():\r\n                tile = ApplicationTile(\r\n                    app_name=row['Solution_Name'],\r\n                    app_description=row['Description'],\r\n                    shared_drive_path=row['ApplicationExePath'],\r\n                    environment=row['Status'],\r\n                    release_date=row['Release_Date'],\r\n                    validity_period=row['Validity_Period'],\r\n                    version_number=float(row['Version_Number']) if row['Version_Number'] else 1.0,\r\n                    registration_id=row['UMAT_IAHub_ID']\r\n                )\r\n                self.all_tiles.append(tile)\r\n\r\n            self.update_grid_layout(\"\")\r\n        except Exception as e:\r\n            # FIXED: Use custom message box\r\n            dialog = CustomMessageBox(\r\n                parent=self,\r\n                title=\"Error\",\r\n                message=f\"Failed to load applications: {str(e)}\",\r\n                icon_type=\"error\"\r\n            )\r\n            dialog.exec()\r\n\r\n    def filter_applications(self, text):\r\n        self.update_grid_layout(text.lower())\r\n\r\n    def update_grid_layout(self, filter_text):\r\n        \"\"\"Update grid with filtered tiles - 4 tiles per row for better spacing\"\"\"\r\n        self.clear_layout(self.app_grid)\r\n\r\n        visible_tiles = [\r\n            tile for tile in self.all_tiles\r\n            if (filter_text in tile.app_name.lower()) and\r\n               (self.current_filter == \"All\" or tile.environment == self.current_filter)\r\n        ]\r\n\r\n        # 4 tiles per row for better spacing (matching the uploaded design)\r\n        for i, tile in enumerate(visible_tiles):\r\n            row = i // 4\r\n            col = i % 4\r\n            self.app_grid.addWidget(tile, row, col)\r\n            tile.setVisible(True)\r\n\r\n        self.app_grid.setRowStretch(len(visible_tiles) // 4 + 1, 1)\r\n\r\n    def clear_layout(self, layout):\r\n        if layout is None:\r\n            return\r\n        while layout.count():\r\n            item = layout.takeAt(0)\r\n            if item.widget():\r\n                item.widget().setParent(None)\r\n\r\n    def get_user_details(self):\r\n        \"\"\"Get user details\"\"\"\r\n        try:\r\n            if self.userdata.empty:\r\n                data = {}  # awmpy.get_phonebook_data(user_main)\r\n                self.cost_center = data['costCenterID']\r\n                details = [\r\n                    (data['standardID'], 'icons8-id-50.png'),\r\n                    (data['nameFull'], 'icons8-user-64.png'),\r\n                    (data['email'], 'icons8-email-50.png'),\r\n                    (data['jobTitle'], 'icons8-new-job-50.png'),\r\n                    (data['buildingName'], 'icons8-location-50.png')\r\n                ]\r\n                add_new_user_to_userbase(\r\n                    [data['standardID'], data['nameFull'], data['email'], data['jobTitle'], data['buildingName'],\r\n                     data['costCenterID']])\r\n            else:\r\n                self.cost_center = str(self.userdata['cost_center_id'].values[0])\r\n                details = [\r\n                    (self.userdata['sid'].values[0], 'icons8-id-50.png'),\r\n                    (self.userdata['display_name'].values[0], 'icons8-user-64.png'),\r\n                    (self.userdata['email'].values[0], 'icons8-email-50.png'),\r\n                    (self.userdata['job_title'].values[0], 'icons8-new-job-50.png'),\r\n                    (self.userdata['building_name'].values[0], 'icons8-location-50.png')\r\n                ]\r\n        except:\r\n            details = DETAILS\r\n        return details\r\n\r\n    def is_administrator(self):\r\n        \"\"\"Check if user is administrator\"\"\"\r\n        try:\r\n            cred = HttpNtlmAuth(SID, password=\"**\")\r\n            site = Site(SITE_URL, auth=cred, verify_ssl=False)\r\n            sp_list = site.List(ADMIN)\r\n            query = {'Where': [('Contains', 'sid', user_main)]}\r\n            sp_data = sp_list.GetListItems(query=query)\r\n            df = pd.DataFrame(sp_data)\r\n            df.fillna(value='', inplace=True)\r\n            managed_lob = df['lob'].tolist()\r\n            return len(managed_lob) > 0\r\n        except:\r\n            return False\r\n\r\n    def is_gfbm_user_check(self):\r\n        \"\"\"Check if user is GFBM\"\"\"\r\n        self.cost_center_df['cost_center_code'] = self.cost_center_df['cost_center_code'].astype(str)\r\n        cc_column = self.cost_center_df['cost_center_code'].to_list()\r\n        return self.cost_center in cc_column\r\n\r\n    def refresh_applications(self):\r\n        \"\"\"Refresh applications list\"\"\"\r\n        self.search_bar.clear()\r\n        try:\r\n            user = user_main.lower()\r\n            urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\r\n            cred = HttpNtlmAuth(SID, password=\"**\")\r\n            site = Site(SITE_URL, auth=cred, verify_ssl=False)\r\n            sp_list = site.List(SHAREPOINT_LIST)\r\n            sp_data = sp_list.GetListItems(view_name=None)\r\n            df_all = pd.DataFrame(sp_data)\r\n            df_all.fillna(value='', inplace=True)\r\n            df_all['SIDs_For_SolutionAccess'] = df_all['SIDs_For_SolutionAccess'].str.lower()\r\n            all_df = df_all[df_all['SIDs_For_SolutionAccess'].str.contains('everyone', na=False)]\r\n            processed_df = df_all[df_all['SIDs_For_SolutionAccess'].str.contains(user, na=False)]\r\n            processed_df = pd.concat([all_df, processed_df])\r\n            processed_df.reset_index(inplace=True)\r\n        except Exception as e:\r\n            if os.path.exists(f\"{os.environ.get('USERPROFILE')}/{BACKUP_PATH}/{BACKUP_FILE_NAME}\"):\r\n                processed_df = pd.read_excel(f\"{os.environ.get('USERPROFILE')}/{BACKUP_PATH}/{BACKUP_FILE_NAME}\")\r\n            else:\r\n                processed_df = pd.DataFrame(\r\n                    columns=['Expired', 'Solution_Name', 'Description', 'ApplicationExePath', 'Status',\r\n                             'Release_Date', 'Validity_Period', 'Version_Number', 'UMAT_IAHub_ID'])\r\n\r\n        self.access = processed_df\r\n        if len(self.access) > 0:\r\n            self.load_applications()\r\n        else:\r\n            self.clear_layout(self.app_grid)\r\n            self.app_grid.setAlignment(Qt.AlignmentFlag.AlignCenter)\r\n            no_access_widget = NoAccessWidget(self.is_gfbm_user)\r\n            self.app_grid.addWidget(no_access_widget, 0, 0, 1, 1, Qt.AlignmentFlag.AlignCenter)\r\n\r\n            # FIXED: Use custom message box\r\n            dialog = CustomMessageBox(\r\n                parent=self,\r\n                title=\"Application\",\r\n                message=\"Refresh Complete...\",\r\n                icon_type=\"info\"\r\n            )\r\n            dialog.exec()"
  },
  {
    "type": "xhr",
    "startTime": 113875.80000001192,
    "method": "GET",
    "url": "/api/v1/files/download?path=%2Fchats%2Fcae475b1e2824bb68b44486a3ae672dd%2Fworkspace%2Frun_demo.py",
    "status": 200,
    "endTime": 114336.30000001192,
    "duration": 460.5,
    "responseText": "#!/usr/bin/env python3\n\"\"\"\nDemo runner for PSLV Software Center\nThis creates a simplified version that can run without all dependencies\n\"\"\"\n\nimport sys\nimport os\n\n# Add current directory to Python path\nsys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))\n\ntry:\n    from PSLV import ApplicationWindow\n    from PyQt6.QtWidgets import QApplication\n    \n    def main():\n        print(\"Starting PSLV Software Center Demo...\")\n        \n        app = QApplication(sys.argv)\n        \n        # Set application-wide stylesheet for modern dark theme\n        app.setStyleSheet(\"\"\"\n            * {\n                font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n            }\n        \"\"\")\n        \n        window = ApplicationWindow()\n        window.show()\n        \n        print(\"Application started successfully!\")\n        print(\"The loading screen will show first, then transition to the main application.\")\n        \n        try:\n            sys.exit(app.exec())\n        except SystemExit:\n            print('Application closed.')\n\n    if __name__ == '__main__':\n        main()\n        \nexcept ImportError as e:\n    print(f\"Missing dependency: {e}\")\n    print(\"Please install PyQt6: pip install PyQt6 pandas\")\n    sys.exit(1)"
  },
  {
    "type": "xhr",
    "startTime": 114834.30000001192,
    "method": "GET",
    "url": "/api/v1/files/download?path=%2Fchats%2Fcae475b1e2824bb68b44486a3ae672dd%2Fworkspace%2Fsecurity_check.py",
    "status": 200,
    "endTime": 115206.20000000298,
    "duration": 371.8999999910593,
    "responseText": "\"\"\"\nSecurity check module for PSLV Launcher\n\"\"\"\nimport os\nimport hashlib\nfrom datetime import datetime\n\nclass LauncherSecurity:\n    \"\"\"Security utilities for launcher\"\"\"\n    \n    @staticmethod\n    def generate_launch_token(executable_path):\n        \"\"\"Generate security token for application launch\"\"\"\n        try:\n            # Create a simple token based on path and timestamp\n            token_data = f\"{executable_path}_{datetime.now().isoformat()}\"\n            token = hashlib.md5(token_data.encode()).hexdigest()\n            \n            # In a real implementation, this would be more sophisticated\n            print(f\"Generated launch token: {token[:8]}...\")\n            return token\n        except Exception as e:\n            print(f\"Error generating launch token: {e}\")\n            return None"
  },
  {
    "type": "xhr",
    "startTime": 115726.5,
    "method": "GET",
    "url": "/api/v1/files/download?path=%2Fchats%2Fcae475b1e2824bb68b44486a3ae672dd%2Fworkspace%2Fstatic.py",
    "status": 200,
    "endTime": 116177.10000000894,
    "duration": 450.6000000089407,
    "responseText": "\"\"\"\nStatic configuration and utility functions for PSLV Launcher\n\"\"\"\nimport os\nimport sys\nimport pandas as pd\nfrom datetime import datetime, timedelta\n\n# Application configuration\nAPP_DIR = \"PSLV_Apps\"\nBACKUP_PATH = \"PSLV_Backup\"\nBACKUP_FILE_NAME = \"applications_backup.xlsx\"\n\n# SharePoint configuration (mock values for demo)\nSITE_URL = \"https://sharepoint.company.com\"\nSID = \"demo_user\"\nSHAREPOINT_LIST = \"Applications\"\nADMIN = \"Administrators\"\n\n# User details for demo\nDETAILS = [\n    (\"Demo User\", \"/images/User.jpg\"),\n    (\"demo.user@company.com\", \"icons8-email-50.png\"),\n    (\"Software Engineer\", \"icons8-new-job-50.png\"),\n    (\"Main Building\", \"/images/Location.jpg\")\n]\n\ndef resource_path(relative_path):\n    \"\"\"Get absolute path to resource, works for dev and for PyInstaller\"\"\"\n    try:\n        # PyInstaller creates a temp folder and stores path in _MEIPASS\n        base_path = sys._MEIPASS\n    except Exception:\n        base_path = os.path.abspath(\".\")\n    \n    return os.path.join(base_path, relative_path)\n\ndef expire_sort(row):\n    \"\"\"Check if application is expired\"\"\"\n    try:\n        release_date = pd.Timestamp(row['Release_Date'])\n        validity_period = row['Validity_Period']\n        expiry_date = release_date + timedelta(days=validity_period)\n        return datetime.now() > expiry_date\n    except:\n        return False\n\ndef add_new_user_to_userbase(user_data):\n    \"\"\"Add new user to userbase (mock function)\"\"\"\n    print(f\"Adding user to userbase: {user_data}\")\n    pass"
  }
]]
